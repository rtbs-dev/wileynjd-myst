%%
%% This is file `mathastext.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% mathastext.dtx  (with options: `package')
%% 
%% IMPORTANT NOTICE:
%% 
%% For the copyright see the source file.
%% 
%% Any modified versions of this file must be renamed
%% with new filenames distinct from mathastext.sty.
%% 
%% For distribution of the original source see the terms
%% for copying and modification in the file mathastext.dtx.
%% 
%% This generated file may be distributed as long as the
%% original source files, as listed above, are part of the
%% same distribution. (The sources need not necessarily be
%% in the same archive or directory.)
%%----------------------------------------------------------------
%% Package: mathastext
%% Info:    Use the text font in math mode (JFB)
%% Version: 1.4e 2024/10/26
%% License: LPPL 1.3c (http://www.latex-project.org/lppl/lppl-1-3c.txt)
%% Copyright (C) 2011-2019, 2022-2024 Jean-Francois Burnol
%%                                   <jfbu at free dot fr>
%% Examples of use of mathastext:
%%        http://jf.burnol.free.fr/mathastext.html
%%        http://jf.burnol.free.fr/showcase.html
%%----------------------------------------------------------------
\NeedsTeXFormat{LaTeX2e}[2020/02/02]
\ProvidesPackage {mathastext}
  [2024/10/26 v1.4e Use the text font in math mode (JFB)]
\def\mst@infoline#1{\immediate\write\m@ne
                    {(\space\space\space mathastext:\space\space\space) #1}}
\immediate\write\m@ne{}
\PackageInfo{mathastext}{Starting the math mode configuration\@gobble}
  \let\mst@Umathcharnumdef\Umathcharnumdef
  \let\mst@Umathcodenum   \Umathcodenum
  \let\mst@Umathcode      \Umathcode
  \let\mst@Umathchardef   \Umathchardef
  \let\mst@Umathaccent    \Umathaccent
\newif\ifmst@XeTeX
\ifx\XeTeXinterchartoks\@undefined
  \mst@XeTeXfalse
\else
  \mst@XeTeXtrue
  \ifx\mst@Umathcharnumdef\@undefined
    \let\mst@Umathcharnumdef\XeTeXmathcharnumdef
    \let\mst@Umathcodenum   \XeTeXmathcodenum
    \let\mst@Umathcode      \XeTeXmathcode
    \let\mst@Umathchardef   \XeTeXmathchardef
    \let\mst@Umathaccent    \XeTeXmathaccent
  \fi
\fi
\newif\ifmst@LuaTeX
\ifx\directlua\@undefined
  \mst@LuaTeXfalse
\else
  \mst@LuaTeXtrue
  \ifx\mst@Umathcharnumdef\@undefined
    \let\mst@Umathcharnumdef\luatexUmathcharnumdef
    \let\mst@Umathcodenum   \luatexUmathcodenum
    \let\mst@Umathcode      \luatexUmathcode
    \let\mst@Umathchardef   \luatexUmathchardef
    \let\mst@Umathaccent    \luatexUmathaccent
  \fi
\fi
\newif\ifmst@XeOrLua
\ifmst@LuaTeX\mst@XeOrLuatrue\fi
\ifmst@XeTeX \mst@XeOrLuatrue\fi
\ifmst@XeTeX
  \def\mst@activemathcodenum@space{"1FFFFF }%
  \let\mst@mathcodenum\mst@Umathcodenum
\else
\ifmst@LuaTeX
  \def\mst@activemathcodenum@space{"1000000 }%
  \let\mst@mathcodenum\mst@Umathcodenum
\else
  \def\mst@activemathcodenum@space{"8000 }%
  \let\mst@mathcodenum\mathcode
\fi\fi
\def\mst@OnlyIfNotMathActive#1{%
    \ifnum\mst@mathcodenum`#1=\mst@activemathcodenum@space
         \expandafter\@gobble
    \else\expandafter\@firstofone
    \fi
}
\def\mst@oti{OT1}
\def\mst@tu{TU}
\def\mst@OneifUniEnc{\ifx\mst@tmp@enc\mst@tu1\else0\fi}
\newif\ifmst@goahead
\newif\ifmst@abort
  \def\mst@enc{\encodingdefault}
  \def\mst@fam{\familydefault}
  \def\mst@ser{\seriesdefault}
  \def\mst@opsh{\shapedefault}
  \def\mst@bold{\bfdefault}
  \def\mst@ltsh{\shapedefault}
  \edef\mst@greekfont{\familydefault}
\newif\ifmst@italic
\newif\ifmst@frenchmath
\newif\ifmst@ncccomma
\newif\ifmst@decimalcomma
\newif\ifmst@binarysemicolon
    \DeclareOption{italic}{\mst@italictrue
        \def\mst@ltsh{\itdefault}}
    \DeclareOption{frenchmath}{\mst@frenchmathtrue\mst@italictrue
      \def\mst@ltsh{\itdefault}}
    \DeclareOption{ncccomma}{\mst@ncccommatrue}
    \DeclareOption{decimalcomma}{\mst@decimalcommatrue}
    \DeclareOption{binarysemicolon}{\mst@binarysemicolontrue}
    \DeclareOption{frenchmath*}{\mst@frenchmathtrue\mst@italictrue
      \def\mst@ltsh{\itdefault}\mst@decimalcommatrue\mst@binarysemicolontrue}
    \DeclareOption{frenchmath+}{\mst@frenchmathtrue\mst@italictrue
      \def\mst@ltsh{\itdefault}\mst@ncccommatrue\mst@binarysemicolontrue}
\newif\ifmst@endash\mst@endashtrue
    \DeclareOption{endash}{\mst@endashtrue}
    \DeclareOption{noendash}{\mst@endashfalse}
\newif\ifmst@emdash
    \DeclareOption{emdash}{\mst@emdashtrue\mst@endashfalse}
\newif\ifmst@alldelims
\edef\mst@tmp{\encodingdefault}\ifx\mst@oti\mst@tmp\else\mst@alldelimstrue\fi
    \DeclareOption{alldelims}{\mst@alldelimstrue}
    \DeclareOption{nolessnomore}{\mst@alldelimsfalse}
\newif\ifmst@nosmalldelims
    \DeclareOption{nosmalldelims}{\mst@nosmalldelimstrue}
\newif\ifmst@noplus
    \DeclareOption{noplus}{\mst@noplustrue}
\newif\ifmst@nominus
    \DeclareOption{nominus}{\mst@nominustrue}
\DeclareOption{noplusnominus}{\ExecuteOptions{noplus,nominus}}
\newif\ifmst@noparen
    \DeclareOption{noparenthesis}{\mst@noparentrue}
\newif\ifmst@nopunct
    \DeclareOption{nopunctuation}{\mst@nopuncttrue}
\newif\ifmst@noequal
    \DeclareOption{noequal}{\mst@noequaltrue}
\newif\ifmst@noexclam
    \DeclareOption{noexclam}{\mst@noexclamtrue}
\newif\ifmst@asterisk
    \DeclareOption{asterisk}{\mst@asterisktrue}
\newif\ifmst@nospecials
    \DeclareOption{nospecials}{\mst@nospecialstrue}
\newif\ifmst@basic
    \DeclareOption{basic}{\mst@basictrue
    \ExecuteOptions{noparenthesis,nopunctuation,%
                    noplusnominus,noequal,noexclam,nospecials,nolessnomore}}
\newif\ifmst@nohbar
    \DeclareOption{nohbar}{\mst@nohbartrue}
\newif\ifmst@activedigits
    \DeclareOption{activedigits}{\mst@activedigitstrue}
\newif\ifmst@nodigits
    \DeclareOption{nodigits}{\mst@nodigitstrue}
\newif\ifmst@defaultimath
    \DeclareOption{defaultimath}{\mst@defaultimathtrue}
\newif\ifmst@noletters
    \DeclareOption{noletters}{\mst@noletterstrue\ExecuteOptions{nohbar,defaultimath}}
\newif\ifmst@mathaccents
    \DeclareOption{mathaccents}{\mst@mathaccentstrue}
\newif\ifmst@unimathaccents
    \DeclareOption{unimathaccents}{\mst@mathaccentstrue\mst@unimathaccentstrue}
\newif\ifmst@needsymbol
\newif\ifmst@symboldelimiters
    \DeclareOption{symboldelimiters}{\mst@needsymboltrue\mst@symboldelimiterstrue}
\newif\ifmst@symboldigits
    \DeclareOption{symboldigits}{\mst@needsymboltrue\mst@symboldigitstrue}
\newif\ifmst@symbolgreek
\newif\ifmst@customgreek
    \DeclareOption{symbolgreek}{\mst@needsymboltrue\mst@symbolgreektrue
                                \mst@customgreektrue }
\newif\ifmst@symbolre
    \DeclareOption{symbolre}{\mst@needsymboltrue\mst@symbolretrue}
\newif\ifmst@symbolmisc
    \DeclareOption{symbolmisc}{\mst@needsymboltrue\mst@symbolmisctrue}
    \DeclareOption{symbol}{\ExecuteOptions{symbolgreek,symbolmisc,symbolre}}
    \DeclareOption{symbolmax}{\ExecuteOptions{symbol,symboldelimiters}}
\newif\ifmst@needeuler
\newif\ifmst@eulerdigits
    \DeclareOption{eulerdigits}{\mst@needeulertrue\mst@eulerdigitstrue}
\newif\ifmst@eulergreek
    \DeclareOption{eulergreek}{\mst@needeulertrue\mst@eulergreektrue
                               \mst@customgreektrue }
\newif\ifmst@selfGreek
    \DeclareOption{selfGreek}{\mst@selfGreektrue\mst@customgreektrue}
\newif\ifmst@selfGreeks
    \DeclareOption{selfGreeks}{\mst@selfGreekstrue\mst@selfGreektrue
                               \mst@customgreektrue }
\newif\ifmst@LGRgreek
    \DeclareOption{LGRgreek}{\mst@LGRgreektrue\mst@customgreektrue}
\newif\ifmst@LGRgreeks
    \DeclareOption{LGRgreeks}{\mst@LGRgreekstrue\mst@LGRgreektrue
                              \mst@customgreektrue}
\newif\ifmst@greekplus
    \DeclareOption{LGRgreek+}{\ExecuteOptions{LGRgreek}\mst@greekplustrue}
    \DeclareOption{LGRgreeks+}{\ExecuteOptions{LGRgreeks}\mst@greekplustrue}
\def\mst@greek@select{0}
\newif\ifmst@itgreek
\newif\ifmst@upgreek
    \DeclareOption{itgreek}{\mst@itgreektrue}
    \DeclareOption{upgreek}{\mst@upgreektrue}
    \DeclareOption{itGreek}{\def\mst@greek@select{1}}
    \DeclareOption{upGreek}{\def\mst@greek@select{2}}
\newif\ifmst@defaultnormal
    \DeclareOption{defaultnormal}{\mst@defaultnormaltrue}
\newif\ifmst@defaultrm
    \DeclareOption{defaultrm}{\mst@defaultrmtrue}
\newif\ifmst@defaultbf
    \DeclareOption{defaultbf}{\mst@defaultbftrue}
\newif\ifmst@defaultit
    \DeclareOption{defaultit}{\mst@defaultittrue}
\newif\ifmst@defaultsf
    \DeclareOption{defaultsf}{\mst@defaultsftrue}
\newif\ifmst@defaulttt
    \DeclareOption{defaulttt}{\mst@defaulttttrue}
\DeclareOption{defaultalphabets}{\ExecuteOptions{defaultnormal,defaultrm,%
defaultbf,defaultit,defaultsf,defaulttt}}
\newif\ifmst@defaultsizes
    \DeclareOption{defaultmathsizes}{\mst@defaultsizestrue}
\newif\ifmst@twelve
    \DeclareOption{12pt}{\mst@twelvetrue}
\newif\ifmst@fouriervec
    \DeclareOption{fouriervec}{\mst@fouriervectrue}
\newif\ifmst@subdued
    \DeclareOption{subdued}{\mst@subduedtrue}
\newif\ifmst@everymath
    \DeclareOption{everymath}{\mst@everymathtrue
\PackageWarningNoLine{mathastext}{%
        `everymath\string' will be removed at next major release.\MessageBreak
        Please report to the author the circumstances\MessageBreak
        which mandated its use in the present document}%
}
\def\mst@unicodeminus {2013}
\def\mst@checkoption #1unicodeminus#2\mst@#3\mst@@
   {\ifx\\#3\\\PackageWarningNoLine{mathastext}
               {Unknown option `\CurrentOption\string'}\else
    \ifx\\#2\\\def\mst@unicodeminus {2212}\else
    \expandafter\def\expandafter\mst@unicodeminus\expandafter{\@secondoftwo#2}%
    \fi\fi}
\DeclareOption*%
  {\expandafter\mst@checkoption\CurrentOption\mst@ unicodeminus\mst@\mst@@}
\ProcessOptions\relax
\def\mst@DeclareMathAccent#1{\let#1\mst@undefined
  \expandafter
  \let\csname\expandafter\@gobble\string#1\space\endcsname\mst@undefined
  \DeclareMathAccent{#1}}
\def\mst@normalversionname{normal}%
\def\mst@boldversionname{bold}%
\def\mst@OnlyIfNotSubdued#1{%
    \ifmst@subdued
      \ifx\math@version\mst@normalversionname
      \else
        \ifx\math@version\mst@boldversionname
        \else
          #1%
        \fi
      \fi
    \else
      #1%
    \fi
}%
\newmuskip\mst@exists@muskip
\newmuskip\mst@forall@muskip
\def\mst@exists@skip{1mu}
\def\mst@forall@skip{.6667mu}
\ifmst@italic\ifmst@frenchmath\else
    \def\mst@exists@skip{0mu}
    \def\mst@forall@skip{0mu}
    \def\mst@prime@skip {0mu}
\fi\fi
\protected\def\mst@exists{\mst@exists@original\mskip\mst@exists@muskip}
\protected\def\mst@forall{\mst@forall@original\mskip\mst@forall@muskip}
\AtBeginDocument{%
   \let\mst@exists@original\exists
   \let\mst@forall@original\forall
   \def\MTnormalexists   {\let\exists\mst@exists@original }%
   \def\MTexistsdoesskip {\let\exists\mst@exists }%
   \def\MTnormalforall   {\let\forall\mst@forall@original }%
   \def\MTforalldoesskip {\let\forall\mst@forall }%
   \ifmst@subdued
   \else
     \MTexistsdoesskip
     \MTforalldoesskip
   \fi
}%
\newcommand*\MTnormalexists   {\AtBeginDocument {\MTnormalexists   }}
\newcommand*\MTexistsdoesskip {\AtBeginDocument {\MTexistsdoesskip }}
\newcommand*\MTnormalforall   {\AtBeginDocument {\MTnormalforall   }}
\newcommand*\MTforalldoesskip {\AtBeginDocument {\MTforalldoesskip }}
\newmuskip\mst@prime@muskip
\def\mst@prime@skip{.5mu}
\ifmst@italic\ifmst@frenchmath\else\def\mst@prime@skip{0mu}\fi\fi
\def\mst@tmp#1{%
\def\mst@mathactivateprime{%
  \ifnum\catcode`#1=\active
    \@ifundefined{active@char#1}
                 {}
                 {\mst@do@activecase #1{}{\mst@active@math@prime}}%
  \else
    \mst@@mathactivate #1{}{\mst@active@math@prime}%
  \fi
}%
\def\mst@undo@mathactivateprime{\mst@mathdeactivate#1{\mst@activemathcodenum@space}}%
}\expandafter\mst@tmp\string'
\def\mst@active@math@prime{\sp\bgroup\mskip\mst@prime@muskip\prim@s}
\ifmst@everymath
    \newcommand*\MTnormalprime  {\let\mst@modifyprime\@empty}
    \newcommand*\MTprimedoesskip{\let\mst@modifyprime\mst@mathactivateprime}%
    \AtBeginDocument{%
      \everymath\expandafter
               {\the\everymath    \mst@modifyprime \MTnormalprime}%
      \everydisplay\expandafter
               {\the\everydisplay \mst@modifyprime \MTnormalprime}%
      \MTprimedoesskip
    }
\else
    \newcommand*\MTnormalprime  {\mst@undo@mathactivateprime}
    \newcommand*\MTprimedoesskip{\mst@mathactivateprime}
    \AtBeginDocument{\MTprimedoesskip}
\fi
\newcommand*\MTexistsskip[1]{\edef\mst@exists@skip{#1}%
    \mst@exists@muskip\mst@exists@skip\relax}
\newcommand*\MTforallskip[1]{\edef\mst@forall@skip{#1}%
    \mst@forall@muskip\mst@forall@skip\relax}
\newcommand*\MTprimeskip[1]{\edef\mst@prime@skip{#1}%
    \mst@prime@muskip\mst@prime@skip\relax}
\let\Mathastextexistsskip\MTexistsskip
\let\Mathastextforallskip\MTforallskip
\let\Mathastextprimeskip\MTprimeskip
\let\mathastextexistsskip\MTexistsskip
\let\mathastextforallskip\MTforallskip
\let\mathastextprimeskip\MTprimeskip
\ifmst@noparen\else
\AtEndOfPackage{%
  \AtBeginDocument{%
    \@ifundefined{resetMathstrut@}
      {}%
      {%
       \let\mst@savedresetMathstrut@\resetMathstrut@
       \ifx\mst@the\the
         \let\mst@the\@gobble
         \MTnonlettersobeymathxx
       \fi
      }%
  }%
}%
\fi
\def\mst@magic@v #1#2#3#4#5{#1#3#4}
\def\mst@magic@vi #1#2#3#4#5#6{#1#2#4#5}
\def\mst@fork{\ifmmode\mst@magic@v\fi\@thirdofthree}
\def\mst@safefork{\ifmmode\if@safe@actives\else\mst@magic@vi\fi\fi\@thirdofthree}
\def\mst@do@activecase#1#2#3{%
    \expandafter\if\string-#1\else
      \ifx\relax #2\relax\mathcode`#1=`#1\relax\else\mathcode`#1=#3\relax\fi
    \fi
    \ifmst@everymath\else\@ifundefined{mst@hackedshorthand@#1}{\fi
    \expandafter\let\csname mst@orig@user@active#1\expandafter\endcsname
                    \csname user@active#1\endcsname
    \expandafter\let\csname mst@orig@normal@char#1\expandafter\endcsname
                    \csname normal@char#1\endcsname
    \ifmst@everymath\else}{}\fi
    \def\mst@tmp##1##2{\def##1{\mst@fork{#2}{#3}##2}}%
    \expandafter\mst@tmp\csname user@active#1\expandafter\endcsname
                        \csname mst@orig@user@active#1\endcsname
    \def\mst@tmp##1##2{\def##1{\mst@safefork{#2}{#3}##2}}%
    \expandafter\mst@tmp\csname normal@char#1\expandafter\endcsname
                        \csname mst@orig@normal@char#1\endcsname
    \ifmst@everymath
    \else
      \expandafter\let\csname mst@hackedshorthand@#1\endcsname\@empty
    \fi
}
\begingroup
  \catcode`\~=\active
  \def\x{%
\endgroup
\ifmst@everymath
   \def\mst@@mathactivate##1##2##3{%
      \begingroup
      \lccode`~=`##1
      \lccode`##1=`##1
      \lowercase{\endgroup
        \mathcode`##1="8000
        \def~{##2##3}%
      }%
    }%
\else
   \def\mst@@mathactivate##1##2##3{%
      \begingroup
      \lccode`~=`##1
      \lccode`##1=`##1
      \lowercase{\endgroup
        \mathcode`##1="8000
        \@ifundefined{mst@prioractivemeaning@##1}
                     {\expandafter\let
                      \csname mst@prioractivemeaning@##1\endcsname ~}
                     {}%
        \def~{\ifmmode\expandafter\@firstoftwo\else\expandafter\@secondoftwo\fi
              {##2##3}{##1}}%
      }%
    }%
\fi
}\x
\def\mst@mathactivate#1#2#3{%
    \ifnum\catcode`#1=\active
      \@ifundefined{active@char#1}{}{\mst@do@activecase #1{#2}{#3}}%
    \else
      \mst@OnlyIfNotMathActive{#1}{\mst@@mathactivate #1{#2}{#3}}%
    \fi
}
\ifmst@everymath
\else
\def\mst@mathdeactivate#1#2{%
  \if#1\string-\else\mst@mathcodenum`#1=#2\relax\fi
  \@ifundefined{active@char#1}
      {\@ifundefined{mst@prioractivemeaning@#1}
             {}%
             {\mst@restoreactivemeaning#1%
              \expandafter\let\csname mst@prioractivemeaning@#1\endcsname\relax}%
      }
      {\@ifundefined{mst@hackedshorthand@#1}
       {}
       {\expandafter\let\csname user@active#1\expandafter\endcsname
                        \csname mst@orig@user@active#1\endcsname
        \expandafter\let\csname normal@char#1\expandafter\endcsname
                       \csname mst@orig@normal@char#1\endcsname
        \expandafter\let\csname mst@hackedshorthand@#1\endcsname\relax
       }%
      }%
}%
\def\mst@restoreactivemeaning#1{%
    \begingroup
    \lccode`~=`#1
    \lccode`#1=`#1
    \lowercase{\endgroup
      \expandafter\let\expandafter~\csname mst@prioractivemeaning@#1\endcsname
    }%
}
\fi
\newtoks\mst@do@nonletters
\ifmst@everymath
\else
    \newtoks\mst@undo@nonletters
\fi
\ifmst@everymath
    \def\mst@addtodo@nonletters#1#2#3{\mst@do@nonletters\expandafter
                   {\the\mst@do@nonletters\mst@mathactivate#1#2#3}%
    }%
\else
    \def\mst@addtodo@nonletters#1#2#3{%
        \mst@do@nonletters\expandafter
                   {\the\mst@do@nonletters\mst@mathactivate#1#2#3}%
        \edef\mst@tmp{\noexpand\mst@mathdeactivate#1{\the\mst@mathcodenum`#1}}%
        \mst@undo@nonletters\expandafter\expandafter\expandafter
                  {\expandafter\mst@tmp\the\mst@undo@nonletters}%
    }%
\fi
\let\mst@the\@gobble
\def\mst@redefine@resetMathstrut@{%
      \@ifundefined{mst@savedresetMathstrut@}
      {}
      {%
        \ifmst@symboldelimiters
          \def\resetMathstrut@{%
           \setbox\z@\hbox{\the\textfont\symmtpsymbol\char40
                        \the\textfont\symmtoperatorfont\char40
                        \the\textfont\symoperators\char40}%
           \ht\Mathstrutbox@\ht\z@ \dp\Mathstrutbox@\dp\z@}%
        \else
          \def\resetMathstrut@{%
           \setbox\z@\hbox{\the\textfont\symmtoperatorfont\char40
                        \the\textfont\symoperators\char40}%
           \ht\Mathstrutbox@\ht\z@ \dp\Mathstrutbox@\dp\z@}%
        \fi
        \PackageInfo{mathastext}{\string\resetMathstrut@\space
        from amsmath replaced for this\MessageBreak group or environment}%
      }%
}%
\def\mst@restore@resetMathstrut@{%
      \@ifundefined{mst@savedresetMathstrut@}{}{%
        \PackageInfo{mathastext}{restoring for this group or environment
                                 the original\MessageBreak
                                 amsmath \protect\resetMathstrut@}%
      \let\resetMathstrut@\mst@savedresetMathstrut@}%
}%
\ifmst@everymath
  \newcommand*\MTnonlettersobeymathxx{%
    \mst@OnlyIfNotSubdued{%
        \ifx\mst@the\the
        \else
           \mst@redefine@resetMathstrut@
        \fi
        \let\mst@the\the
    }%
  }%
  \newcommand*\MTnonlettersdonotobeymathxx{%
    \ifx\mst@the\@gobble
    \else
      \mst@restore@resetMathstrut@
    \fi
    \let\mst@the\@gobble
  }%
\else
  \newcommand*\MTnonlettersobeymathxx{%
     \mst@OnlyIfNotSubdued{%
        \AtBeginDocument{\MTnonlettersobeymathxx}%
     }%
  }%
  \newcommand*\MTnonlettersdonotobeymathxx{%
     \AtBeginDocument{\MTnonlettersdonotobeymathxx}%
  }%
  \AtBeginDocument{%
    \renewcommand*\MTnonlettersobeymathxx{%
        \mst@OnlyIfNotSubdued{%
             \the\mst@do@nonletters
             \ifx\mst@the\the
             \else
                \mst@redefine@resetMathstrut@
             \fi
             \let\mst@the\the
         }%
    }%
    \renewcommand*\MTnonlettersdonotobeymathxx{%
        \the\mst@undo@nonletters
        \ifx\mst@the\@gobble
        \else
           \mst@restore@resetMathstrut@
        \fi
        \let\mst@the\@gobble
    }%
  }%
\fi
\newtoks\mst@do@easynonletters
\ifmst@everymath
    \newcommand*\MTeasynonlettersdonotobeymathxx{\let\mst@theeasy\@gobble}%
    \newcommand*\MTeasynonlettersobeymathxx{%
                \mst@OnlyIfNotSubdued{\let\mst@theeasy\the}%
    }%
    \MTeasynonlettersobeymathxx
\else
    \newtoks\mst@undo@easynonletters
    \newcommand*\MTeasynonlettersdonotobeymathxx{\the\mst@undo@easynonletters}
    \newcommand*\MTeasynonlettersobeymathxx{%
                \mst@OnlyIfNotSubdued{\the\mst@do@easynonletters}%
    }%
    \AtEndOfPackage{\MTeasynonlettersobeymathxx}%
\fi
\ifmst@everymath
    \def\mst@addtodo@easynonletters#1#2{%
      \mst@do@easynonletters\expandafter{%
          \the\mst@do@easynonletters
          \mst@OnlyIfNotMathActive{#1}{\mathcode`#1=#2}%
      }%
    }%
    \def\mst@addtodo@easynonletters@U#1#2{%
      \mst@do@easynonletters\expandafter{%
          \the\mst@do@easynonletters
          \mst@OnlyIfNotMathActive{#1}{\mst@Umathcodenum`#1=#2}%
      }%
    }%
\else
    \def\mst@addtodo@easynonletters#1#2{%
      \mst@do@easynonletters\expandafter
                            {\the\mst@do@easynonletters
                             \mst@OnlyIfNotMathActive{#1}{\mathcode`#1=#2}}%
      \def\mst@tmp##1\relax{%
          \def\mst@tmp{\mst@OnlyIfNotMathActive{#1}{\mathcode`#1=##1\relax}}%
      }%
      \expandafter\mst@tmp\the\mathcode`#1\relax
      \mst@undo@easynonletters\expandafter\expandafter\expandafter
               {\expandafter\mst@tmp\the\mst@undo@easynonletters}%
    }%
    \def\mst@addtodo@easynonletters@U#1#2{%
      \mst@do@easynonletters\expandafter{%
         \the\mst@do@easynonletters
         \mst@OnlyIfNotMathActive{#1}{\mst@Umathcodenum`#1=#2}%
      }%
      \def\mst@tmp##1\relax{%
          \def\mst@tmp{\mst@OnlyIfNotMathActive{#1}{\mst@Umathcodenum`#1=##1\relax}}%
      }%
      \expandafter\mst@tmp\the\mst@Umathcodenum`#1\relax
      \mst@undo@easynonletters\expandafter\expandafter\expandafter
               {\expandafter\mst@tmp\the\mst@undo@easynonletters}%
    }%
\fi
\ifmst@basic
\else
 \ifmst@XeOrLua
  \AtBeginDocument {%
  \ifx\newmcodes@\@undefined\else
  \edef\mst@newmcodes@{%
   \mst@Umathcode `\noexpand\' 0 \symmtoperatorfont 39\relax
   \ifmst@asterisk
    \mst@Umathcode `\noexpand\* 0 \symmtoperatorfont 42\relax
   \else\mathcode`\noexpand\* 42
   \fi
   \ifmst@nopunct\mathcode `\noexpand\."613A \mathcode `\noexpand\: "603A
   \else
    \mst@Umathcode `\noexpand\. 6 \symmtoperatorfont 46\relax
    \mst@Umathcode `\noexpand\: 6 \symmtoperatorfont 58\relax
   \fi
   \ifmst@nominus\mathcode`\noexpand\- 45
   \else
      \mst@Umathcode `\noexpand\- 0 \symmtoperatorfont 45\relax
   \fi
   \ifmst@noparen\mathcode `\noexpand\/  47
   \else
      \mst@Umathcode `\noexpand\/ 0 \symmtoperatorfont 47\relax
   \fi
  }%
  \let\mst@originalnewmcodes@\newmcodes@
  \fi
  }%
 \else
  \AtBeginDocument {%
  \ifx\newmcodes@\@undefined\else
  \edef\mst@newmcodes@{%
    \mathcode`\noexpand\' \the\numexpr\symmtoperatorfont*\@cclvi+39\relax
    \mathcode`\noexpand\*
      \the\numexpr\ifmst@asterisk\symmtoperatorfont*\@cclvi\fi+42\relax
    \ifmst@nopunct\mathcode `\noexpand\."613A \mathcode `\noexpand\: "603A
    \else
      \mathcode`\noexpand\. \the\numexpr\mst@varfam@dot-"1000\relax
      \mathcode`\noexpand\: \the\numexpr\mst@varfam@colon-"1000\relax
    \fi
    \mathcode`\noexpand\-
     \the\numexpr\unless\ifmst@nominus\symmtoperatorfont*\@cclvi\fi+45\relax
    \mathcode`\noexpand\/
     \the\numexpr\unless\ifmst@noparen\symmtoperatorfont*\@cclvi\fi+47\relax\relax
    }%
  \let\mst@originalnewmcodes@\newmcodes@
  \fi
  }%
 \fi
\fi
\newcommand*\MTresetnewmcodes{\ifx\mst@originalnewmcodes@\undefined\else
                               \let\newmcodes@\mst@originalnewmcodes@\fi}
\newcommand*\MTcustomizenewmcodes{\ifx\mst@originalnewmcodes@\undefined\else
                               \let\newmcodes@\mst@newmcodes@\fi}
\DeclareSymbolFont{mtoperatorfont}{\mst@enc}{\mst@fam}{\mst@ser}{\mst@opsh}
\newcommand*{\MTmathoperatorsobeymathxx}
{\def\operator@font{\mathgroup\ifnum\fam=\m@ne\symmtoperatorfont\else\fam\fi}}
\newcommand*{\MTmathoperatorsdonotobeymathxx}
{\def\operator@font{\mathgroup\symmtoperatorfont}}
\MTmathoperatorsobeymathxx
\DeclareSymbolFont{mtletterfont}{\mst@enc}{\mst@fam}{\mst@ser}{\mst@ltsh}
\def\mst@fixmathfonts@#1.#2.#3.{%
\def\mst@fixmathfonts@##1##2#1=##3;##4##5\relax##6\@empty##7{%
  \ifx##3\empty\else
   \if"##1%
    \font\mst@mathfont=##1##2#1=base;##4##5\relax
   \else
    \mst@arrrrgh@fixmathfonts##1##2#1=base;##4##5#2\empty#3\relax
   \fi
   ##7=\mst@mathfont
  \fi
}%
\def\mst@arrrrgh@fixmathfonts##1#2##2##3#3##4\relax{%
  \ifx##2\empty
    \font\mst@mathfont="##1"\relax
  \else
    \font\mst@mathfont="##1"#2##2##3#3\relax
  \fi
}%
}%
\expandafter\mst@fixmathfonts@\detokenize{mode. at.pt.}%
\def\MTfixmathfonts#1{%
\def\MTfixmathfonts{%
  \expandafter\mst@fixmathfonts@\fontname\textfont\symmtoperatorfont
  \relax\relax #1=;\empty\relax\@empty{\textfont\symmtoperatorfont}%
  \expandafter\mst@fixmathfonts@\fontname\scriptfont\symmtoperatorfont
  \relax\relax #1=;\empty\relax\@empty{\scriptfont\symmtoperatorfont}%
  \expandafter\mst@fixmathfonts@\fontname\scriptscriptfont\symmtoperatorfont
  \relax\relax #1=;\empty\relax\@empty{\scriptscriptfont\symmtoperatorfont}%
  \expandafter\mst@fixmathfonts@\fontname\textfont\symmtletterfont
  \relax\relax #1=;\empty\relax\@empty{\textfont\symmtletterfont}%
  \expandafter\mst@fixmathfonts@\fontname\scriptfont\symmtletterfont
  \relax\relax #1=;\empty\relax\@empty{\scriptfont\symmtletterfont}%
  \expandafter\mst@fixmathfonts@\fontname\scriptscriptfont\symmtletterfont
  \relax\relax #1=;\empty\relax\@empty{\scriptscriptfont\symmtletterfont}%
}}%
\expandafter\MTfixmathfonts\expandafter{\detokenize{mode}}%
\ifmst@LuaTeX
  \everymath\expandafter{\the\everymath\mst@fixmathfonts}%
  \everydisplay\expandafter{\the\everydisplay\mst@fixmathfonts}%
\fi
\newcommand*\MTfixfonts{\let\mst@fixmathfonts\MTfixmathfonts}%
\newcommand*\MTdonotfixfonts{\let\mst@fixmathfonts\empty}%
\MTfixfonts
\let\mst@alph@omicron\mathnormal
\@ifpackageloaded{fourier}{\ifsloped\else\let\mst@alph@omicron\mathrm\fi}{}
\DeclareSymbolFontAlphabet{\Mathnormal}{mtletterfont}
\DeclareSymbolFontAlphabet{\Mathrm}{mtoperatorfont}
   \DeclareMathAlphabet{\Mathnormalbold}{\mst@enc}{\mst@fam}{\mst@bold}{\mst@ltsh}
   \protected\def\mathnormalbold{\Mathnormalbold}
   \DeclareMathAlphabet{\Mathbf}{\mst@enc}{\mst@fam}{\mst@bold}{\mst@opsh}
   \DeclareMathAlphabet{\Mathit}{\mst@enc}{\mst@fam}{\mst@ser}{\itdefault}
   \DeclareMathAlphabet{\Mathsf}{\mst@enc}{\sfdefault}{\mst@ser}{\mst@opsh}
   \DeclareMathAlphabet{\Mathtt}{\mst@enc}{\ttdefault}{\mst@ser}{\mst@opsh}
\let\mst@original@normal\mathnormal
\let\mst@original@rm\mathrm
\let\mst@original@bf\mathbf
\let\mst@original@it\mathit
\let\mst@original@sf\mathsf
\let\mst@original@tt\mathtt
\def\mst@restorealphabets{%
    \let\mathnormal\mst@original@normal
    \let\mathrm\mst@original@rm
    \let\mathbf\mst@original@bf
    \let\mathit\mst@original@it
    \let\mathsf\mst@original@sf
    \let\mathtt\mst@original@tt
  }
\ifmst@greekplus
  \def\mst@mathalph{-1}
  \def\mst@setalphabets{%
    \protected\def
    \mathnormalbold##1{\def\mst@mathalph{4 }\Mathnormalbold{##1}\def\mst@mathalph{-1 }}%
    \ifmst@defaultnormal\else
        \protected\def
        \mathnormal##1{\def\mst@mathalph{0 }\Mathnormal{##1}\def\mst@mathalph{-1 }}%
    \fi
    \ifmst@defaultrm\else
        \protected\def
        \mathrm##1{\def\mst@mathalph{1 }\Mathrm{##1}\def\mst@mathalph{-1 }}%
    \fi
    \ifmst@defaultbf\else
        \protected\def
        \mathbf##1{\def\mst@mathalph{2 }\Mathbf{##1}\def\mst@mathalph{-1 }}%
    \fi
    \ifmst@defaultit\else
        \protected\def
        \mathit##1{\def\mst@mathalph{3 }\Mathit{##1}\def\mst@mathalph{-1 }}%
    \fi
    \ifmst@defaultsf\else\protected\def\mathsf{\Mathsf}\fi
    \ifmst@defaulttt\else\protected\def\mathtt{\Mathtt}\fi
  }
\else
  \def\mst@setalphabets{%
    \ifmst@defaultnormal\else\protected\def\mathnormal{\Mathnormal}\fi
    \ifmst@defaultrm\else\protected\def\mathrm{\Mathrm}\fi
    \ifmst@defaultbf\else\protected\def\mathbf{\Mathbf}\fi
    \ifmst@defaultit\else\protected\def\mathit{\Mathit}\fi
    \ifmst@defaultsf\else\protected\def\mathsf{\Mathsf}\fi
    \ifmst@defaulttt\else\protected\def\mathtt{\Mathtt}\fi
  }
\fi
\ifmst@subdued\else\mst@setalphabets\fi
\providecommand*\MTgreekupdefault{n}
\providecommand*\MTgreekitdefault{it}
\newif\ifmst@greek@lower@up
\newif\ifmst@greek@upper@up
\def\mst@update@greeksh#1#2{
    \def\mst@greek@lsh{#1}
    \def\mst@greek@ush{#2}
    \mst@greek@lower@uptrue
      \expandafter\in@\expanded{{\mst@greek@lsh.}}{it.,sl.}%
      \ifin@\mst@greek@lower@upfalse\fi
    \mst@greek@upper@uptrue
      \expandafter\in@\expanded{{\mst@greek@ush.}}{it.,sl.}%
      \ifin@\mst@greek@upper@upfalse\fi
    \ifmst@itgreek
      \def\mst@greek@ush{\MTgreekitdefault}
        \mst@greek@lower@upfalse
        \mst@greek@upper@upfalse
    \fi
    \ifmst@upgreek
      \def\mst@greek@ush{\MTgreekupdefault}
        \mst@greek@lower@uptrue
        \mst@greek@upper@uptrue
    \fi
    \ifmst@frenchmath
      \ifmst@itgreek\else
      \ifmst@upgreek\else
        \def\mst@greek@ush{#2}
          \mst@greek@lower@uptrue
          \mst@greek@upper@uptrue
      \fi\fi
    \fi
    \ifcase\mst@greek@select
        \or
          \def\mst@greek@ush{\MTgreekitdefault}
            \mst@greek@upper@upfalse
       \or
          \def\mst@greek@ush{\MTgreekupdefault}
            \mst@greek@upper@uptrue
    \fi
}
\mst@update@greeksh{\mst@ltsh}{\mst@opsh}
\ifmst@LGRgreek
    \DeclareFontEncoding{LGR}{}{}
    \DeclareSymbolFont{mtgreekup}{LGR}{\mst@fam}{\mst@ser}{\MTgreekupdefault}
    \DeclareSymbolFont{mtgreekit}{LGR}{\mst@fam}{\mst@ser}{\MTgreekitdefault}
    \DeclareSymbolFontAlphabet{\mathgreekup}{mtgreekup}
    \DeclareSymbolFontAlphabet{\mathgreekit}{mtgreekit}
    \DeclareMathAlphabet{\mathgreekupbold}{LGR}{\mst@fam}{\mst@bold}{\MTgreekupdefault}
    \DeclareMathAlphabet{\mathgreekitbold}{LGR}{\mst@fam}{\mst@bold}{\MTgreekitdefault}
\else
\ifmst@selfGreek
    \DeclareSymbolFont{mtselfGreekfont}{OT1}{\mst@fam}{\mst@ser}{\mst@greek@ush}
\fi\fi
\ifmst@needeuler
\mst@infoline{will use Euler font; command \string\MTEulerScale}
  \DeclareSymbolFont{mteulervm}{U}{zeur}{m}{n}
  \DeclareSymbolFontAlphabet{\MathEuler}{mteulervm}
  \DeclareMathAlphabet{\MathEulerBold}{U}{zeur}{\mst@bold}{n}
\fi
\newcommand*\MTEulerScale[1]{\edef\zeu@Scale{#1}}
\let\MathastextEulerScale\MTEulerScale
\ifmst@needsymbol
  \mst@infoline{will use Symbol font; command \string\MTSymbolScale}
  \def\psy@scale{1}
  \DeclareSymbolFont{mtpsymbol}{U}{psy}{m}{n}
  \DeclareSymbolFontAlphabet{\MathPSymbol}{mtpsymbol}
  \AtBeginDocument{%
    \DeclareFontFamily{U}{psy}{}%
    \DeclareFontShape{U}{psy}{m}{n}{<->s*[\psy@scale] psyr}{}%
  }
\fi
\newcommand*\MTSymbolScale[1]{\edef\psy@scale{#1}}
\let\MathastextSymbolScale\MTSymbolScale
\protected\def\pmvec#1{%
    \mathord{\stackrel{\raisebox{-.5ex}{\tiny\boldmath$\mathord{\rightarrow}$}}%
                      {{}#1}%
            }%
}
\ifmst@fouriervec
  \DeclareFontEncoding{FML}{}{}
  \DeclareFontSubstitution{FML}{futm}{m}{it}
  \DeclareSymbolFont{mathastextfourier}{FML}{futm}{m}{it}
  \SetSymbolFont{mathastextfourier}{bold}{FML}{futm}{b}{it}
  \mst@DeclareMathAccent{\fouriervec}{\mathord}{mathastextfourier}{"7E}
\fi
\newcommand*\MTencoding[1]{\def\mst@enc{#1}}
\newcommand*\MTfamily[1]{\def\mst@fam{#1}}
\newcommand*\MTseries[1]{\def\mst@ser{#1}}
\newcommand*\MTshape[1]{\def\mst@opsh{#1}\ifmst@italic\else\def\mst@ltsh{#1}\fi}
\newcommand*\MTboldvariant[1]{\def\mst@bold{#1}}
\newcommand*\MTlettershape[1]{\def\mst@ltsh{#1}}
\let\Mathastextencoding\MTencoding
\let\Mathastextfamily\MTfamily
\let\Mathastextseries\MTseries
\let\Mathastextshape\MTshape
\let\Mathastextboldvariant\MTboldvariant
\let\Mathastextlettershape\MTlettershape
\newcommand*\MTitgreek{\mst@itgreektrue\mst@upgreekfalse\def\mst@greek@select{0}}
\newcommand*\MTupgreek{\mst@upgreektrue\mst@itgreekfalse\def\mst@greek@select{0}}
\newcommand*\MTitGreek{\def\mst@greek@select{1}}
\newcommand*\MTupGreek{\def\mst@greek@select{2}}
\let\Mathastextitgreek\MTitgreek
\let\Mathastextupgreek\MTupgreek
\let\MathastextitGreek\MTitGreek
\let\MathastextupGreek\MTupGreek
\newcommand*\MTgreekfont[1]{\def\mst@greekfont{#1}}
\let\Mathastextgreekfont\MTgreekfont
\ifmst@noletters
  \let\MTmathactiveletters\@empty
  \let\MTmathactiveLetters\@empty
  \let\MTmathstandardletters\@empty
\else
\def\mst@DeclareMathLetter#1#2#3#4#5{%
    \DeclareMathSymbol {#1}{\mathalpha}{mtletterfont}{`#1}%
    \DeclareMathSymbol {#4}{\mathalpha}{mtletterfont}{`#1}%
    \def#2{{#3#4#5\mst@itcorr}}%
}%
\@tfor\mst@tmp:=abcdefghijklmnopqrstuvwxyz\do{%
   \expandafter\expandafter\expandafter\mst@DeclareMathLetter
   \expandafter\mst@tmp
               \csname MTcommandletter\mst@tmp\expandafter\endcsname
               \csname mst@before@\mst@tmp\expandafter\endcsname
               \csname MTmathcharletter\mst@tmp\expandafter\endcsname
               \csname mst@after@\mst@tmp\endcsname
}%
\ifmst@frenchmath \def\mst@font@tbu{mtoperatorfont}%
   \else          \def\mst@font@tbu{mtletterfont}%
\fi
\def\mst@DeclareMathLetter #1#2#3#4#5{%
    \DeclareMathSymbol {#1}{\mathalpha}{\mst@font@tbu}{`#1}%
    \DeclareMathSymbol {#4}{\mathalpha}{\mst@font@tbu}{`#1}%
    \def#2{{#3#4#5\mst@ITcorr}}%
}%
\@tfor\mst@tmp:=ABCDEFGHIJKLMNOPQRSTUVWXYZ\do{%
   \expandafter\expandafter\expandafter\mst@DeclareMathLetter
   \expandafter\mst@tmp
               \csname MTcommandletter\mst@tmp\expandafter\endcsname
               \csname mst@before@\mst@tmp\expandafter\endcsname
               \csname MTmathcharletter\mst@tmp\expandafter\endcsname
               \csname mst@after@\mst@tmp\endcsname
}%
\def\mst@mathactivate@lowercase{%
    \@tfor\mst@tmp:=abcdefghijklmnopqrstuvwxyz\do{%
      \expandafter\expandafter\expandafter
      \mst@mathactivate\expandafter\mst@tmp\csname MTcommandletter\mst@tmp\endcsname{}%
     }%
}%
\def\mst@mathactivate@uppercase{%
    \@tfor\mst@tmp:=ABCDEFGHIJKLMNOPQRSTUVWXYZ\do{%
      \expandafter\expandafter\expandafter
      \mst@mathactivate\expandafter\mst@tmp\csname MTcommandletter\mst@tmp\endcsname{}%
     }%
}%
\def\mst@mathdeactivate@lowercase{%
    \@tfor\mst@tmp:=abcdefghijklmnopqrstuvwxyz\do{%
      \expandafter\mathcode\expandafter`\mst@tmp=\csname MTmathcharletter\mst@tmp\endcsname
     }%
}%
\def\mst@mathdeactivate@uppercase{%
    \@tfor\mst@tmp:=ABCDEFGHIJKLMNOPQRSTUVWXYZ\do{%
      \expandafter\mathcode\expandafter`\mst@tmp=\csname MTmathcharletter\mst@tmp\endcsname
     }%
}%
\ifmst@everymath
\else
  \def\mst@mathdeactivate@lowercase{%
    \@tfor\mst@tmp:=abcdefghijklmnopqrstuvwxyz\do{%
      \expandafter\mathcode\expandafter`\mst@tmp=
             \csname MTmathcharletter\mst@tmp\endcsname
     }%
  }%
  \def\mst@mathdeactivate@uppercase{%
    \@tfor\mst@tmp:=ABCDEFGHIJKLMNOPQRSTUVWXYZ\do{%
      \expandafter\mathcode\expandafter`\mst@tmp=
             \csname MTmathcharletter\mst@tmp\endcsname
     }%
  }%
\fi
\def\mst@mathactivateletters{%
    \mst@mathactivate@lowercase
    \mst@mathactivate@uppercase
}%
\newcommand*\MTmathactiveletters{%
    \mst@OnlyIfNotSubdued
    \mst@mathactivateletters
}%
\AtEndOfPackage{\MTmathactiveletters}%
\def\mst@mathactivateLetters{\mst@activate@uppercase}%
\newcommand*\MTmathactiveLetters{%
    \mst@OnlyIfNotSubdued
    \mst@mathactivateLetters
}%
\newcommand*\MTmathstandardletters{%
    \mst@mathdeactivate@lowercase
    \mst@mathdeactivate@uppercase
}%
\fi
\newcommand*\MTicinmath{%
    \MTmathactiveletters
    \def\mst@itcorr{\ifnum\fam=\m@ne\/\fi}%
    \let\mst@ITcorr\mst@itcorr
}
\newcommand*\MTICinmath{%
    \MTmathactiveLetters
    \def\mst@ITcorr{\ifnum\fam=\m@ne\/\fi}%
}
\newcommand*\MTnoicinmath{\let\mst@itcorr\@empty\let\mst@ITcorr\@empty}
\newcommand*\MTnoICinmath{\let\mst@ITcorr\@empty}
\newcommand*\MTicalsoinmathxx{%
    \ifx\mst@itcorr\@empty\else\def\mst@itcorr{\/}\fi
    \ifx\mst@ITcorr\@empty\else\def\mst@ITcorr{\/}\fi
}
\newcommand*\MTsetmathskips[3]{%
    \@namedef{mst@before@#1}{\ifnum\fam=\m@ne\mskip#2\relax\fi}%
    \@namedef{mst@after@#1}{\ifnum\fam=\m@ne\mskip#3\relax\fi}%
}
\newcommand*\MTunsetmathskips[1]{%
    \@namedef{mst@before@#1}{}%
    \@namedef{mst@after@#1}{}%
}
\let\MTmathactivedigits\empty
\let\MTmathstandarddigits\empty
\ifmst@nodigits\else
  \def\mst@font@tbu{mtoperatorfont}%
  \ifmst@symboldigits \def\mst@font@tbu{mtpsymbol}\fi
  \ifmst@eulerdigits  \def\mst@font@tbu{mteulervm}\fi
  \DeclareMathSymbol{0}{\mathalpha}{\mst@font@tbu}{`0}%
  \DeclareMathSymbol{1}{\mathalpha}{\mst@font@tbu}{`1}%
  \DeclareMathSymbol{2}{\mathalpha}{\mst@font@tbu}{`2}%
  \DeclareMathSymbol{3}{\mathalpha}{\mst@font@tbu}{`3}%
  \DeclareMathSymbol{4}{\mathalpha}{\mst@font@tbu}{`4}%
  \DeclareMathSymbol{5}{\mathalpha}{\mst@font@tbu}{`5}%
  \DeclareMathSymbol{6}{\mathalpha}{\mst@font@tbu}{`6}%
  \DeclareMathSymbol{7}{\mathalpha}{\mst@font@tbu}{`7}%
  \DeclareMathSymbol{8}{\mathalpha}{\mst@font@tbu}{`8}%
  \DeclareMathSymbol{9}{\mathalpha}{\mst@font@tbu}{`9}%
  \ifmst@activedigits
    \def\mst@DeclareMathDigit #1#2#3{%
      \DeclareMathSymbol{#3}{\mathalpha}{\mst@font@tbu}{`#1}%
      \def#2{#3}%
    }%
    \@tfor\mst@tmp:=0123456789\do{%
      \expandafter\expandafter\expandafter\mst@DeclareMathDigit
      \expandafter\mst@tmp
               \csname MTcommanddigit\romannumeral\mst@tmp\expandafter\endcsname
               \csname MTmathchardigit\romannumeral\mst@tmp\endcsname
    }%
    \def\mst@mathactivatedigits{%
      \@tfor\mst@tmp:=0123456789\do{%
      \expandafter\expandafter\expandafter\mst@mathactivate
      \expandafter\mst@tmp\csname MTcommanddigit\romannumeral\mst@tmp\endcsname{}%
     }%
    }%
    \def\MTmathactivedigits{\mst@OnlyIfNotSubdued\mst@mathactivatedigits}%
    \MTmathactivedigits
    \ifmst@everymath
      \def\MTmathstandarddigits{%
        \@tfor\mst@tmp:=0123456789\do{%
        \expandafter\mathcode\expandafter`\mst@tmp
            =\csname MTmathchardigit\romannumeral\mst@tmp\endcsname
         }%
      }%
    \else
      \def\MTmathstandarddigits{%
        \@tfor\mst@tmp:=0123456789\do{%
        \expandafter\mathcode\expandafter`\mst@tmp
            =\csname MTmathchardigit\romannumeral\mst@tmp\endcsname
         }%
      }%
    \fi
  \fi
\fi
\ifmst@symboldelimiters
\def\mst@font@tbu{mtpsymbol}%
\mst@endashfalse
\mst@emdashfalse
\else
\def\mst@font@tbu{mtoperatorfont}%
\fi
\ifmst@noexclam\else\mst@infoline{\string! and \string?}%
\DeclareMathSymbol{!}{\mathclose}{\mst@font@tbu}{"21}%
\DeclareMathSymbol{\mst@varfam@exclam}{\mathalpha}{\mst@font@tbu}{"21}%
\expandafter\mst@addtodo@nonletters\string!\mathclose\mst@varfam@exclam
\DeclareMathSymbol{?}{\mathclose}{\mst@font@tbu}{"3F}%
\DeclareMathSymbol{\mst@varfam@question}{\mathalpha}{\mst@font@tbu}{"3F}%
\expandafter\mst@addtodo@nonletters\string?\mathclose\mst@varfam@question
\fi
\let\MTnormalasterisk\empty
\let\MTactiveasterisk\empty
\ifmst@asterisk\mst@infoline{asterisk: \string\ast\space and *}
  \ifmst@symbolmisc
    \protected\def\mst@bin@ast{\mathbin{\mathchoice
           {\raisebox{-.1\height}{\the\textfont\symmtpsymbol\char42}}%
           {\raisebox{-.1\height}{\the\textfont\symmtpsymbol\char42}}%
           {\raisebox{-.1\height}{\the\scriptfont\symmtpsymbol\char42}}%
           {\raisebox{-.1\height}{\the\scriptscriptfont\symmtpsymbol\char42}}}%
                     }%
  \else
    \protected\def\mst@bin@ast{\mathbin{\mathchoice
           {\raisebox{-\mst@lowerast}{\the\textfont\symmtoperatorfont\char42}}%
           {\raisebox{-\mst@lowerast}{\the\textfont\symmtoperatorfont\char42}}%
           {\raisebox{-\mst@lowerast}{\the\scriptfont\symmtoperatorfont\char42}}%
           {\raisebox{-\mst@lowerast}{\the\scriptscriptfont\symmtoperatorfont\char42}}}%
                     }%
  \fi
  \protected\def\mst@varfam@ast{\ifnum\fam=\m@ne
                      \mst@bin@ast
                      \else
                      \mathbin{\mathchoice
           {\raisebox{-\mst@lowerast}{\the\textfont\fam\char42}}%
           {\raisebox{-\mst@lowerast}{\the\textfont\fam\char42}}%
           {\raisebox{-\mst@lowerast}{\the\scriptfont\fam\char42}}%
           {\raisebox{-\mst@lowerast}{\the\scriptscriptfont\fam\char42}}}%
                      \fi}%
  \let\mst@ast\mst@bin@ast
  \newcommand*\MTlowerast[1]{\def\mst@lowerast{#1}}
  \MTlowerast{.3\height}
  \mst@do@easynonletters\expandafter{%
      \the\mst@do@easynonletters\let\mst@ast\mst@varfam@ast
  }%
  \ifmst@everymath
     \def\mst@@doasterisk  {\let\ast\mst@ast\mst@mathactivate*{}\mst@ast}%
     \def\MTnormalasterisk {\let\mst@doasterisk\relax}
     \def\MTactiveasterisk {\let\mst@doasterisk\mst@@doasterisk}
     \MTactiveasterisk
     \AtBeginDocument{%
       \everymath\expandafter
              {\the\everymath   \mst@doasterisk \MTnormalasterisk }%
       \everydisplay\expandafter
              {\the\everydisplay\mst@doasterisk \MTnormalasterisk }%
     }%
  \else
     \def\MTnormalasterisk{\AtBeginDocument{\MTnormalasterisk}}
     \def\MTactiveasterisk{\AtBeginDocument{\MTactiveasterisk}}
     \mst@undo@easynonletters\expandafter{%
          \the\mst@do@easynonletters\let\mst@ast\mst@bin@ast
     }%
     \AtBeginDocument{%
         \let\mst@orig@abd@ast\ast
         \edef\MTnormalasterisk{\noexpand\mst@mathdeactivate*{\the\mst@mathcodenum`\*}%
                                \let\noexpand\ast\noexpand\mst@orig@abd@ast}%
         \def\MTactiveasterisk{\def\ast{\mst@ast}%
                               \mst@mathactivate*{}\mst@ast
                              }%
         \MTactiveasterisk
     }
  \fi
\fi
\ifmst@nopunct\else\mst@infoline{punctuation\string: \string, \string. \string:
    \string; and \string\colon}
  \DeclareMathSymbol{,}{\mathpunct}{\mst@font@tbu}{"2C}
  \DeclareMathSymbol{\mst@varfam@comma}{\mathalpha}{\mst@font@tbu}{"2C}
  \ifmst@decimalcomma
    \mst@infoline{loading package decimalomma for `smart comma\string'}
    \RequirePackage{decimalcomma}[2023/12/28]% 1.3 or later
    \let\mathcomma\relax
    \DeclareMathSymbol{\mathcomma}{\mathpunct}{\mst@font@tbu}{"2C}
    \def\mst@sm@rtcomma{\begingroup\@tfor\@tempa:=0123456789%
                        \do{\expandafter\ifx\@tempa\@let@token
                                                  \aftergroup\mathord
                                                  \aftergroup\@gobble
                                                  \@break@tfor\fi}%
                        \endgroup\mathpunct\mathcomma}
    \mst@do@nonletters\expandafter{\the\mst@do@nonletters
      \let\mathcomma\mst@varfam@comma
      \let\sm@rtcomma\mst@sm@rtcomma
      }
    \ifmst@everymath
    \else
      \edef\mst@tmp{\mathchardef\mathcomma=\the\mathcode`\,\relax}%
      \mst@undo@nonletters\expandafter\expandafter\expandafter
                  {\expandafter\mst@tmp\the\mst@undo@nonletters}%
    \fi
  \else
  \ifmst@ncccomma
    \mst@infoline{loading package ncccomma for `smart comma\string'}
    \RequirePackage{ncccomma}%
    \AtBeginDocument{%
      \mathcode`\,="8000\relax
      \@ifpackageloaded{babel}{%
                 \addto\noextrasfrench{\mathcode`\,="8000\relax}%
                 \addto\extrasfrench{\mathcode`\,="8000\relax}%
                 }{}%
    }
    \let\mathcomma\relax
    \DeclareMathSymbol{\mathcomma}{\mathpunct}{\mst@font@tbu}{"2C}
    \edef\mst@NCC@comma{\let\noexpand\@empty\mathpunct
                        \unexpanded\expandafter{\NCC@comma}%
                        \let\noexpand\@empty\noexpand\empty}
    \mst@do@nonletters\expandafter{\the\mst@do@nonletters
      \let\mathcomma\mst@varfam@comma
      \let\NCC@comma\mst@NCC@comma
      }
    \ifmst@everymath
    \else
      \edef\mst@tmp{\mathchardef\mathcomma=\the\mathcomma\relax}%
      \mst@undo@nonletters\expandafter\expandafter\expandafter
                  {\expandafter\mst@tmp\the\mst@undo@nonletters}%
    \fi
  \else
    \expandafter\mst@addtodo@nonletters\string,\mathpunct\mst@varfam@comma
  \fi\fi
  \DeclareMathSymbol{.}{\mathord}{\mst@font@tbu}{"2E}
  \DeclareMathSymbol{\mst@varfam@dot}{\mathalpha}{\mst@font@tbu}{"2E}
  \mst@addtodo@easynonletters\.\mst@varfam@dot
  \DeclareMathSymbol{:}{\mathrel}{\mst@font@tbu}{"3A}
  \DeclareMathSymbol{\mst@varfam@colon}{\mathalpha}{\mst@font@tbu}{"3A}
  \expandafter\mst@addtodo@nonletters\string:\mathrel\mst@varfam@colon
  \@ifpackageloaded{amsmath}
  {}
  {%
    \let\colon\undefined
    \DeclareMathSymbol{\colon}{\mathpunct}{\mst@font@tbu}{"3A}
    \let\mst@colon\colon
    \mst@do@nonletters\expandafter{%
        \the\mst@do@nonletters
        \protected\def\colon{\mathpunct{\mst@varfam@colon}}%
    }%
    \ifmst@everymath
    \else
        \mst@undo@nonletters\expandafter{%
            \the\mst@undo@nonletters
            \let\colon\mst@colon
         }%
    \fi
  }
  \DeclareMathSymbol{\mst@varfam@pointvirgule}{\mathalpha}{\mst@font@tbu}{"3B}
  \ifmst@binarysemicolon
    \mst@infoline{semi-colon set to be of type \string\mathbin}
    \DeclareMathSymbol{;}{\mathbin}{\mst@font@tbu}{"3B}
    \expandafter\mst@addtodo@nonletters\string;\mathbin\mst@varfam@pointvirgule
  \else
    \DeclareMathSymbol{;}{\mathpunct}{\mst@font@tbu}{"3B}
    \expandafter\mst@addtodo@nonletters\string;\mathpunct\mst@varfam@pointvirgule
  \fi
\fi
\ifmst@nominus
\else
  \ifmst@XeOrLua
    \mst@Umathcharnumdef\mst@minus@sign=\mst@Umathcodenum`\-\relax
  \else
    \mathchardef\mst@minus@sign=\mathcode`\-\relax
  \fi
  \@ifpackageloaded{amsmath}
    {\DeclareRobustCommand\relbar{\mathrel{\mathpalette\mathsm@sh\mst@minus@sign}}}
    {\DeclareRobustCommand\relbar{\mathrel{\smash\mst@minus@sign}}}
  \DeclareRobustCommand\rightarrowfill{$\m@th\mathord{\relbar}\mkern-7mu%
  \cleaders\hbox{$\mkern-2mu\relbar\mkern-2mu$}\hfill
  \mkern-7mu\mathord\rightarrow$}
  \DeclareRobustCommand\leftarrowfill{$\m@th\mathord\leftarrow\mkern-7mu%
  \cleaders\hbox{$\mkern-2mu\relbar\mkern-2mu$}\hfill
  \mkern-7mu\mathord{\relbar}$}
\fi
\let\mst@subduedminus\empty
\let\mst@nonsubduedminus\empty
\def\mst@dothe@endashstuff#1#2#3#4{%
  \edef\mst@tmp@enc{#3}%
  \if1\mst@OneifUniEnc
    \mst@Umathchardef#1=2 \symmtoperatorfont "\mst@unicodeminus\relax
    \mst@Umathchardef#2=7 \symmtoperatorfont "\mst@unicodeminus\relax
  \else
    \@ifundefined{\mst@tmp@enc\string\textendash}%
        {%
          \PackageWarningNoLine{mathastext}
          {Impossible to let the \string- use an EN-DASH in a math\MessageBreak
           version with \mst@tmp@enc\space encoding, as there is none there.\MessageBreak
           Reverting to default in math version #4}%
          \let#1\relax\let#2\relax
        }%
        {%
          \DeclareMathSymbol{#1}{\mathbin}{mtoperatorfont}
                            {\csname\mst@tmp@enc\string\textendash\endcsname}%
          \DeclareMathSymbol{#2}{\mathalpha}{mtoperatorfont}
                            {\csname\mst@tmp@enc\string\textendash\endcsname}%
        }%
  \fi
}%
\def\mst@dothe@emdashstuff#1#2#3#4{%
  \edef\mst@tmp@enc{#3}%
  \if1\mst@OneifUniEnc
    \mst@Umathchardef#1=2 \symmtoperatorfont "2014\relax
    \mst@Umathchardef#2=7 \symmtoperatorfont "2014\relax
  \else
    \@ifundefined{\mst@tmp@enc\string\textendash}%
        {%
          \PackageWarningNoLine{mathastext}
          {Impossible to let the \string- use an EM-DASH in a math\MessageBreak
           version with \mst@tmp@enc\space encoding, as there is none there.\MessageBreak
           Reverting to default in math version #4}%
          \let#1\relax\let#2\relax
        }%
        {%
          \DeclareMathSymbol{#1}{\mathbin}{mtoperatorfont}
                            {\csname\mst@tmp@enc\string\textemdash\endcsname}%
          \DeclareMathSymbol{#2}{\mathalpha}{mtoperatorfont}
                            {\csname\mst@tmp@enc\string\textemdash\endcsname}%
        }%
  \fi
}%
\def\mst@dothe@hyphenstuff#1#2{%
  \DeclareMathSymbol{#1}{\mathbin}{\mst@font@tbu}{"2D}%
  \DeclareMathSymbol{#2}{\mathalpha}{\mst@font@tbu}{"2D}%
}%
\def\mst@varfam@minus{\csname mst@varfam@minus@mv\math@version\endcsname}%
\def\mst@minus{\csname mst@minus@mv\math@version\endcsname}%
\ifmst@nominus\else
  \ifmst@everymath
    \expandafter\mst@addtodo@nonletters\string-\mathbin\mst@varfam@minus
  \else
    \def\mst@tmp#1{%
      \mst@do@nonletters\expandafter{\the\mst@do@nonletters
        \@ifundefined{mst@minus@mv\math@version}
            {\mst@nonmathmathactiveminus}
            {\mst@mathactivate#1\mathbin\mst@varfam@minus}%
        }%
      \mst@undo@nonletters\expandafter{\the\mst@undo@nonletters
         \mst@mathdeactivate#1{}%
         \mst@nonmathactiveminus}%
    }\expandafter\mst@tmp\string-%
    \def\mst@nonmathactiveminus{%
        \ifmst@subdued
         \ifx\math@version\mst@normalversionname\mst@subduedminus\else
         \ifx\math@version\mst@boldversionname  \mst@subduedminus\else
         \mst@nonsubduedminus\fi\fi
        \else
         \mst@nonsubduedminus
        \fi}%
  \fi
  \def\mst@nonsubduedminus{%
    \edef\mst@tmp@enc{\csname mst@encoding@\math@version\endcsname}%
    \if1\mst@OneifUniEnc
     \mst@Umathcode`\-=\expandafter
                       \mst@ParseUmathchardef
                       \csname mst@minus@mv\math@version\endcsname
                       \relax
    \else
     \@ifundefined{mst@minus@mv\mst@tmp@enc}
        {\mst@subduedminus}
        {\mathcode`\-=\mst@minus}%
    \fi
  }%
  \def\mst@ParseUmathchardef{\expandafter\mst@ParseUmathchardef@i\meaning}%
  \def\mst@ParseUmathchardef@i#1"{"}%
  \ifmst@endash\else\ifmst@emdash\else
    \def\mst@nonsubduedminus{\mathcode`\-=\mst@minus}%
  \fi\fi
\fi
\let\mst@subduedhbar\@empty
\let\mst@nonsubduedhbar\@empty
\ifmst@nohbar\else
  \def\mst@subduedhbar{\let\hbar\mst@original@hbar}%
  \def\mst@nonsubduedhbar{\expandafter
       \let\expandafter\hbar\csname mst@hbar@mv\math@version\endcsname
       \ifx\hbar\relax\let\hbar\mst@original@hbar\fi}%
\fi
\def\mst@mathrlap{\mathpalette\mst@mathrlapinternal}
\def\mst@mathrlapinternal#1#2{\rlap{$\mathsurround=0pt#1{#2}$}}
\def\mst@dothe@hbarstuff#1#2#3#4{%
  \edef\mst@tmp@enc{#3}%
  \if1\mst@OneifUniEnc
    \mst@Umathchardef#1="7 \symmtletterfont "0127 \relax %% or 210F?
  \else
    \@ifundefined{\mst@tmp@enc\string\=}%
        {%
          \PackageWarningNoLine{mathastext}
          {Impossible to define the \string\hbar\space using a font with\MessageBreak
           \mst@tmp@enc\space encoding, as there is no \string\= accent.\MessageBreak
           Reverting to default \string\hbar\space in math version #4}%
          \let#1\relax
        }%
        {%
         \begingroup
         \def\@text@composite##1\@text@composite##2{##2}%
         \let\add@accent\@firstoftwo
         \mst@DeclareMathAccent{#2}{\mathalpha}{mtletterfont}%
                   {\csname\mst@tmp@enc\string\=\endcsname{}}%
         \endgroup
         \protected\def#1{\mst@mathrlap{#2{\ }}\MTmathcharletterh}%
        }%
  \fi
}%
\ifmst@noplus\else\mst@infoline{\string+ and \string=}
\DeclareMathSymbol{+}{\mathbin}{\mst@font@tbu}{"2B}
\DeclareMathSymbol{\mst@varfam@plus}{\mathalpha}{\mst@font@tbu}{"2B}
\expandafter\mst@addtodo@nonletters\string+\mathbin\mst@varfam@plus
\fi
\ifmst@noequal\else
\ifmst@XeOrLua
    \mst@Umathcharnumdef\mst@equal@sign=\mst@Umathcodenum`\=\relax
\else
    \mathchardef\mst@equal@sign=\mathcode`\=\relax
\fi
\DeclareRobustCommand\Relbar{\mathrel\mst@equal@sign}
\DeclareMathSymbol{=}{\mathrel}{\mst@font@tbu}{"3D}
\DeclareMathSymbol{\mst@varfam@equal}{\mathalpha}{\mst@font@tbu}{"3D}
\mst@infoline{adding \string= \string; and \string+ to \string\nfss@catcodes}
\g@addto@macro\nfss@catcodes{%
  \@makeother\=%
  \@makeother\;%
  \@makeother\+%
}
\expandafter\mst@addtodo@nonletters\string=\mathrel\mst@varfam@equal
\fi
\ifmst@noparen\else
\mst@infoline{parentheses \string( \string) \string[ \string] and slash \string/}
\ifmst@nosmalldelims
    \DeclareMathSymbol{(}{\mathopen}{\mst@font@tbu}{"28}
    \DeclareMathSymbol{)}{\mathclose}{\mst@font@tbu}{"29}
    \DeclareMathSymbol{[}{\mathopen} {\mst@font@tbu}{"5B}
    \DeclareMathSymbol{]}{\mathclose}{\mst@font@tbu}{"5D}
    \DeclareMathSymbol{/}{\mathord}{\mst@font@tbu}{"2F}
\else
    \DeclareMathDelimiter{(}{\mathopen}{\mst@font@tbu}{"28}{largesymbols}{"00}
    \DeclareMathDelimiter{)}{\mathclose}{\mst@font@tbu}{"29}{largesymbols}{"01}
    \DeclareMathDelimiter{[}{\mathopen} {\mst@font@tbu}{"5B}{largesymbols}{"02}
    \DeclareMathDelimiter{]}{\mathclose}{\mst@font@tbu}{"5D}{largesymbols}{"03}
    \DeclareMathDelimiter{/}{\mathord}{\mst@font@tbu}{"2F}{largesymbols}{"0E}
\fi
\DeclareMathSymbol{\mst@varfam@lparen}{\mathalpha}{\mst@font@tbu}{40}
\DeclareMathSymbol{\mst@varfam@rparen}{\mathalpha}{\mst@font@tbu}{41}
\DeclareMathSymbol{\mst@varfam@lbrack}{\mathalpha}{\mst@font@tbu}{"5B}
\DeclareMathSymbol{\mst@varfam@rbrack}{\mathalpha}{\mst@font@tbu}{"5D}
\DeclareMathSymbol{\mst@varfam@slash}{\mathalpha}{\mst@font@tbu}{"2F}
\expandafter\mst@addtodo@nonletters\string(\mathopen\mst@varfam@lparen
\expandafter\mst@addtodo@nonletters\string)\mathclose\mst@varfam@rparen
\expandafter\mst@addtodo@nonletters\string[\mathopen\mst@varfam@lbrack
\expandafter\mst@addtodo@nonletters\string]\mathclose\mst@varfam@rbrack
\mst@addtodo@easynonletters\/\mst@varfam@slash
\fi
\ifmst@alldelims\mst@infoline{alldelims: \string< \string>
  \string\backslash\space\string\setminus\space\string|
  \string\vert\space\string\mid\space\string\{\space \string\}}
\ifmst@nosmalldelims
    \DeclareMathDelimiter{\mst@varfam@backslash}
        {\mathalpha}{symbols}{"6E}{largesymbols}{"0F}
    \let\mst@mathord@backslash\backslash
\else
    \DeclareMathDelimiter{<}{\mathopen}{\mst@font@tbu}{"3C}{largesymbols}{"0A}
    \DeclareMathDelimiter{>}{\mathclose}{\mst@font@tbu}{"3E}{largesymbols}{"0B}
    \DeclareMathDelimiter{\mst@mathord@backslash}
        {\mathord}{mtoperatorfont}{"5C}{largesymbols}{"0F}
    \let\backslash\mst@mathord@backslash
    \DeclareMathDelimiter{\mst@varfam@backslash}
        {\mathalpha}{mtoperatorfont}{"5C}{largesymbols}{"0F}
\fi
\DeclareMathSymbol{<}{\mathrel}{\mst@font@tbu}{"3C}
\DeclareMathSymbol{>}{\mathrel}{\mst@font@tbu}{"3E}
\DeclareMathSymbol{\mst@varfam@less}{\mathalpha}{\mst@font@tbu}{"3C}
\DeclareMathSymbol{\mst@varfam@more}{\mathalpha}{\mst@font@tbu}{"3E}
\expandafter\mst@addtodo@nonletters\string<\mathrel\mst@varfam@less
\expandafter\mst@addtodo@nonletters\string>\mathrel\mst@varfam@more
\mst@do@easynonletters\expandafter{\the\mst@do@easynonletters
            \let\backslash\mst@varfam@backslash}
\ifmst@everymath
\else
  \mst@undo@easynonletters\expandafter{\the\mst@undo@easynonletters
            \let\backslash\mst@mathord@backslash}
\fi
\DeclareMathSymbol{\setminus}{\mathbin}{mtoperatorfont}{"5C}
\let\mst@setminus\setminus
\DeclareMathSymbol{\mst@varfam@setminus}{\mathalpha}{mtoperatorfont}{"5C}
\mst@do@nonletters\expandafter{%
     \the\mst@do@nonletters
     \protected\def\setminus{\mathbin{\mst@varfam@setminus}}%
}
\ifmst@everymath
\else
    \mst@undo@nonletters\expandafter{%
         \the\mst@undo@nonletters
         \let\setminus\mst@setminus
    }
\fi
\ifmst@XeOrLua
  \mst@Umathcharnumdef\mst@vert@bar=\mst@Umathcodenum`\|\relax
\else
  \mathchardef\mst@vert@bar=\mathcode`\|\relax
\fi
\DeclareRobustCommand\models{\mathrel{\mst@vert@bar}\joinrel\Relbar}
\ifmst@nosmalldelims
    \DeclareMathSymbol{|}{\mathord}{\mst@font@tbu}{124}
\else
    \DeclareMathDelimiter{|}{\mathord}{\mst@font@tbu}{124}{largesymbols}{"0C}
\fi
\protected\def\vert{|}
\DeclareMathSymbol{\mst@varfam@vbar}{\mathalpha}{\mst@font@tbu}{124}
\mst@addtodo@easynonletters\|\mst@varfam@vbar
\let\mid\undefined
\DeclareMathSymbol{\mid}{\mathrel}{\mst@font@tbu}{124}
\let\mst@mid\mid
\mst@do@nonletters\expandafter{%
    \the\mst@do@nonletters
    \protected\def\mid{\mathrel\mst@varfam@vbar}%
}
\ifmst@everymath
\else
    \mst@undo@nonletters\expandafter{%
        \the\mst@undo@nonletters
        \let\mid\mst@mid
    }
\fi
  \ifmst@nosmalldelims
  \else
     \let\lbrace\undefined \let\rbrace\undefined
     \DeclareMathDelimiter{\lbrace}
        {\mathopen}{\mst@font@tbu}{123}{largesymbols}{"08}
     \DeclareMathDelimiter{\rbrace}
        {\mathclose}{\mst@font@tbu}{125}{largesymbols}{"09}
  \fi
\DeclareMathSymbol{\mst@varfam@lbrace}{\mathalpha}{\mst@font@tbu}{123}
\DeclareMathSymbol{\mst@varfam@rbrace}{\mathalpha}{\mst@font@tbu}{125}
\protected\def\mst@lbrace{\ifmmode\mathopen\mst@varfam@lbrace\else\textbraceleft\fi}
\protected\def\mst@rbrace{\ifmmode\mathclose\mst@varfam@rbrace\else\textbraceright\fi}
\mst@do@nonletters\expandafter{%
    \the\mst@do@nonletters
    \mst@dobraces{\let\{\mst@lbrace\let\}\mst@rbrace}%
}
\fi
\newcommand*{\MTexplicitbracesobeymathxx}{\let\mst@dobraces\@firstofone}
\newcommand*{\MTexplicitbracesdonotobeymathxx}{\let\mst@dobraces\@gobble}
\ifmst@everymath
\else
    \renewcommand*\MTexplicitbracesobeymathxx{%
        \let\mst@dobraces\@firstofone
        \MTnonlettersobeymathxx
    }%
    \renewcommand*\MTexplicitbracesdonotobeymathxx{%
        \let\mst@dobraces\@gobble
        \protected\def\{{\ifmmode \lbrace \else \textbraceleft \fi}%
        \protected\def\}{\ifmmode \rbrace \else \textbraceright \fi}%
    }%
    \mst@undo@nonletters\expandafter{\the\mst@undo@nonletters
        \protected\def\{{\ifmmode \lbrace \else \textbraceleft \fi}%
        \protected\def\}{\ifmmode \rbrace \else \textbraceright \fi}%
    }%
\fi
\MTexplicitbracesdonotobeymathxx
\ifmst@nospecials
\else
  \mst@infoline{\string\#\space\string\mathdollar\space
                \string\%\space\string\&\space}
  \ifmst@XeOrLua
    \mst@Umathcode`\#=0 \symmtoperatorfont "23 \relax
    \mst@Umathchardef\mathdollar=0 \symmtoperatorfont "24 \relax
    \mst@Umathcode`\%=0 \symmtoperatorfont "25 \relax
    \mst@Umathcode`\&=0 \symmtoperatorfont "26 \relax
    \mst@Umathchardef\mst@varfam@mathhash      = 7 \symmtoperatorfont "23 \relax
    \mst@Umathchardef\mst@varfam@mathdollar    = 7 \symmtoperatorfont "24 \relax
    \mst@Umathchardef\mst@varfam@mathpercent   = 7 \symmtoperatorfont "25 \relax
    \mst@Umathchardef\mst@varfam@mathampersand = 7 \symmtoperatorfont "26 \relax
    \mst@addtodo@easynonletters@U\#\mst@varfam@mathhash
    \mst@addtodo@easynonletters@U\%\mst@varfam@mathpercent
    \mst@addtodo@easynonletters@U\&\mst@varfam@mathampersand
  \else
    \count@=\symmtoperatorfont
    \multiply\count@ by \@cclvi
    \advance\count@ by 35
        \mathcode`\#\count@
    \advance\count@ by \@ne
        \mathchardef\mathdollar\count@
    \advance\count@ by \@ne
        \mathcode`\%\count@
    \advance\count@ by \@ne
        \mathcode`\&\count@
    \count@=\symmtoperatorfont
    \multiply\count@ by \@cclvi
    \advance\count@ by 28707 % = "7023
        \mathchardef\mst@varfam@mathhash\count@
    \advance\count@ by \@ne
        \mathchardef\mst@varfam@mathdollar\count@
    \advance\count@ by \@ne
        \mathchardef\mst@varfam@mathpercent\count@
    \advance\count@ by \@ne
        \mathchardef\mst@varfam@mathampersand\count@
    \mst@addtodo@easynonletters\#\mst@varfam@mathhash
    \mst@addtodo@easynonletters\%\mst@varfam@mathpercent
    \mst@addtodo@easynonletters\&\mst@varfam@mathampersand
  \fi
  \mst@do@easynonletters\expandafter{\the\mst@do@easynonletters
    \let\mathdollar\mst@varfam@mathdollar}%
  \ifmst@everymath\else
      \edef\mst@tmp{\ifmst@XeOrLua\mst@Umathcharnumdef\else\mathchardef\fi
                    \mathdollar=\the\mathdollar\relax}%
      \mst@undo@easynonletters\expandafter\expandafter\expandafter
               {\expandafter\mst@tmp\the\mst@undo@easynonletters}%
  \fi
\fi
\ifmst@symbolmisc
\mst@infoline{symbolmisc: miscellaneous math symbols from Symbol font}
\let\MToriginalprod\prod
\DeclareMathSymbol{\prodpsy}{\mathop}{mtpsymbol}{213}
\protected\def\prod{\ifinner\prodpsy\else\MToriginalprod\fi}
\let\MToriginalsum\sum
\DeclareMathSymbol{\sumpsy}{\mathop}{mtpsymbol}{229}
\protected\def\sum{\ifinner\sumpsy\else\MToriginalsum\fi}
\DeclareMathSymbol{\mst@implies}{\mathrel}{mtpsymbol}{222}
\protected\def\implies{\;\mst@implies\;}
\DeclareMathSymbol{\mst@impliedby}{\mathrel}{mtpsymbol}{220}
\protected\def\impliedby{\;\mst@impliedby\;}
\protected\def\iff{\;\mst@impliedby\mathrel{\mkern-3mu}\mst@implies\;}
\DeclareMathSymbol{\mst@iff}{\mathrel}{mtpsymbol}{219}
\protected\def\shortiff{\;\mst@iff\;}
\let\to\relax
\DeclareMathSymbol{\to}{\mathrel}{mtpsymbol}{174}
\DeclareMathSymbol{\mst@trait}{\mathrel}{mtpsymbol}{190}
\protected\def\longto{\mkern2mu\mst@trait\mathrel{\mkern-10mu}\to}
\protected\def\mapsto{\mapstochar\mathrel{\mkern0.2mu}\to}
\protected\def\longmapsto{%
    \mapstochar\mathrel{\mkern2mu}\mst@trait\mathrel{\mkern-10mu}\to
}
\DeclareMathSymbol{\aleph}{\mathord}{mtpsymbol}{192}
\DeclareMathSymbol{\inftypsy}{\mathord}{mtpsymbol}{165}
\DeclareMathSymbol{\emptyset}{\mathord}{mtpsymbol}{198}
\let\varnothing\emptyset
\DeclareMathSymbol{\nabla}{\mathord}{mtpsymbol}{209}
\DeclareMathSymbol{\surd}{\mathop}{mtpsymbol}{214}
\let\angle\undefined
\DeclareMathSymbol{\angle}{\mathord}{mtpsymbol}{208}
\DeclareMathSymbol{\forall}{\mathord}{mtpsymbol}{34}
\DeclareMathSymbol{\exists}{\mathord}{mtpsymbol}{36}
\DeclareMathSymbol{\neg}{\mathord}{mtpsymbol}{216}
\DeclareMathSymbol{\clubsuit}{\mathord}{mtpsymbol}{167}
\DeclareMathSymbol{\diamondsuit}{\mathord}{mtpsymbol}{168}
\DeclareMathSymbol{\heartsuit}{\mathord}{mtpsymbol}{169}
\DeclareMathSymbol{\spadesuit}{\mathord}{mtpsymbol}{170}
\DeclareMathSymbol{\smallint}{\mathop}{mtpsymbol}{242}
\DeclareMathSymbol{\wedge}{\mathbin}{mtpsymbol}{217}
\DeclareMathSymbol{\vee}{\mathbin}{mtpsymbol}{218}
\DeclareMathSymbol{\cap}{\mathbin}{mtpsymbol}{199}
\DeclareMathSymbol{\cup}{\mathbin}{mtpsymbol}{200}
\DeclareMathSymbol{\bullet}{\mathbin}{mtpsymbol}{183}
\DeclareMathSymbol{\div}{\mathbin}{mtpsymbol}{184}
\DeclareMathSymbol{\otimes}{\mathbin}{mtpsymbol}{196}
\DeclareMathSymbol{\oplus}{\mathbin}{mtpsymbol}{197}
\DeclareMathSymbol{\pm}{\mathbin}{mtpsymbol}{177}
\DeclareMathSymbol{\times}{\mathbin}{mtpsymbol}{180}
\DeclareMathSymbol{\proptopsy}{\mathrel}{mtpsymbol}{181}
\DeclareMathSymbol{\mid}{\mathrel}{mtpsymbol}{124}
\DeclareMathSymbol{\leq}{\mathrel}{mtpsymbol}{163}
\DeclareMathSymbol{\geq}{\mathrel}{mtpsymbol}{179}
\DeclareMathSymbol{\approx}{\mathrel}{mtpsymbol}{187}
\DeclareMathSymbol{\supset}{\mathrel}{mtpsymbol}{201}
\DeclareMathSymbol{\subset}{\mathrel}{mtpsymbol}{204}
\DeclareMathSymbol{\supseteq}{\mathrel}{mtpsymbol}{202}
\DeclareMathSymbol{\subseteq}{\mathrel}{mtpsymbol}{205}
\DeclareMathSymbol{\in}{\mathrel}{mtpsymbol}{206}
\DeclareMathSymbol{\sim}{\mathrel}{mtpsymbol}{126}
\let\cong\undefined
\DeclareMathSymbol{\cong}{\mathrel}{mtpsymbol}{64}
\DeclareMathSymbol{\perp}{\mathrel}{mtpsymbol}{94}
\DeclareMathSymbol{\equiv}{\mathrel}{mtpsymbol}{186}
\let\notin\undefined
\DeclareMathSymbol{\notin}{\mathrel}{mtpsymbol}{207}
\DeclareMathDelimiter{\rangle}
   {\mathclose}{mtpsymbol}{241}{largesymbols}{"0B}
\DeclareMathDelimiter{\langle}
   {\mathopen}{mtpsymbol}{225}{largesymbols}{"0A}
\fi
\ifmst@symbolre
\mst@infoline{symbolre: \string\Re\space and \string\Im\space from Symbol font}
\DeclareMathSymbol{\Re}{\mathord}{mtpsymbol}{"C2}
\DeclareMathSymbol{\Im}{\mathord}{mtpsymbol}{"C1}
\DeclareMathSymbol{\DotTriangle}{\mathord}{mtpsymbol}{92}
\fi
\let\mst@mathord\mathalpha
\mst@goaheadtrue
\ifmst@selfGreek
    \def\mst@font@tbu{mtselfGreekfont}
\else
    \ifmst@eulergreek
        \def\mst@font@tbu{mteulervm}
    \else
      \ifmst@symbolgreek
        \def\mst@font@tbu{mtpsymbol}
        \let\mst@mathord\mathord
      \else
         \ifmst@LGRgreek
            \mst@goaheadfalse
         \else
           \mst@goaheadfalse
           \def\mst@omicron {\mst@alph@omicron{o}}
         \fi
      \fi
   \fi
\fi
\ifmst@goahead
  \DeclareMathSymbol{\mst@Alpha}{\mst@mathord}{\mst@font@tbu}{"41}
  \DeclareMathSymbol{\mst@Beta}{\mst@mathord}{\mst@font@tbu}{"42}
  \DeclareMathSymbol{\mst@Epsilon}{\mst@mathord}{\mst@font@tbu}{"45}
  \DeclareMathSymbol{\mst@Zeta}{\mst@mathord}{\mst@font@tbu}{"5A}
  \DeclareMathSymbol{\mst@Eta}{\mst@mathord}{\mst@font@tbu}{"48}
  \DeclareMathSymbol{\mst@Iota}{\mst@mathord}{\mst@font@tbu}{"49}
  \DeclareMathSymbol{\mst@Kappa}{\mst@mathord}{\mst@font@tbu}{"4B}
  \DeclareMathSymbol{\mst@Mu}{\mst@mathord}{\mst@font@tbu}{"4D}
  \DeclareMathSymbol{\mst@Nu}{\mst@mathord}{\mst@font@tbu}{"4E}
  \DeclareMathSymbol{\mst@Omicron}{\mst@mathord}{\mst@font@tbu}{"4F}
  \DeclareMathSymbol{\mst@Rho}{\mst@mathord}{\mst@font@tbu}{"50}
  \DeclareMathSymbol{\mst@Tau}{\mst@mathord}{\mst@font@tbu}{"54}
  \DeclareMathSymbol{\mst@Chi}{\mst@mathord}{\mst@font@tbu}{"58}
  \ifx\mst@mathord\mathord
    \DeclareMathSymbol{\mst@Rho}{\mathord}{mtpsymbol}{"52}
    \DeclareMathSymbol{\mst@Chi}{\mathord}{mtpsymbol}{"43}
    \DeclareMathSymbol{\mst@Gamma}{\mathord}{mtpsymbol}{"47}
    \DeclareMathSymbol{\mst@Delta}{\mathord}{mtpsymbol}{"44}
    \DeclareMathSymbol{\mst@Theta}{\mathord}{mtpsymbol}{"51}
    \DeclareMathSymbol{\mst@Lambda}{\mathord}{mtpsymbol}{"4C}
    \DeclareMathSymbol{\mst@Xi}{\mathord}{mtpsymbol}{"58}
    \DeclareMathSymbol{\mst@Pi}{\mathord}{mtpsymbol}{"50}
    \DeclareMathSymbol{\mst@Sigma}{\mathord}{mtpsymbol}{"53}
    \DeclareMathSymbol{\mst@Upsilon}{\mathord}{mtpsymbol}{"A1}
    \DeclareMathSymbol{\mst@Phi}{\mathord}{mtpsymbol}{"46}
    \DeclareMathSymbol{\mst@Psi}{\mathord}{mtpsymbol}{"59}
    \DeclareMathSymbol{\mst@Omega}{\mathord}{mtpsymbol}{"57}
  \else
    \DeclareMathSymbol\mst@Digamma  {\mathalpha}{\mst@font@tbu}{"46}
    \DeclareMathSymbol\mst@Gamma    {\mathalpha}{\mst@font@tbu}{"00}
    \DeclareMathSymbol\mst@Delta    {\mathalpha}{\mst@font@tbu}{"01}
    \DeclareMathSymbol\mst@Theta    {\mathalpha}{\mst@font@tbu}{"02}
    \DeclareMathSymbol\mst@Lambda   {\mathalpha}{\mst@font@tbu}{"03}
    \DeclareMathSymbol\mst@Xi       {\mathalpha}{\mst@font@tbu}{"04}
    \DeclareMathSymbol\mst@Pi       {\mathalpha}{\mst@font@tbu}{"05}
    \DeclareMathSymbol\mst@Sigma    {\mathalpha}{\mst@font@tbu}{"06}
    \DeclareMathSymbol\mst@Upsilon  {\mathalpha}{\mst@font@tbu}{"07}
    \DeclareMathSymbol\mst@Phi      {\mathalpha}{\mst@font@tbu}{"08}
    \DeclareMathSymbol\mst@Psi      {\mathalpha}{\mst@font@tbu}{"09}
    \DeclareMathSymbol\mst@Omega    {\mathalpha}{\mst@font@tbu}{"0A}
  \fi
\fi
\ifmst@goahead
 \ifmst@eulergreek
  \DeclareMathSymbol{\mst@alpha}  {\mathalpha}{mteulervm}{"0B}
  \DeclareMathSymbol{\mst@beta}   {\mathalpha}{mteulervm}{"0C}
  \DeclareMathSymbol{\mst@gamma}  {\mathalpha}{mteulervm}{"0D}
  \DeclareMathSymbol{\mst@delta}  {\mathalpha}{mteulervm}{"0E}
  \DeclareMathSymbol{\mst@epsilon}{\mathalpha}{mteulervm}{"0F}
  \DeclareMathSymbol{\mst@zeta}   {\mathalpha}{mteulervm}{"10}
  \DeclareMathSymbol{\mst@eta}    {\mathalpha}{mteulervm}{"11}
  \DeclareMathSymbol{\mst@theta}  {\mathalpha}{mteulervm}{"12}
  \DeclareMathSymbol{\mst@iota}   {\mathalpha}{mteulervm}{"13}
  \DeclareMathSymbol{\mst@kappa}  {\mathalpha}{mteulervm}{"14}
  \DeclareMathSymbol{\mst@lambda} {\mathalpha}{mteulervm}{"15}
  \DeclareMathSymbol{\mst@mu}     {\mathalpha}{mteulervm}{"16}
  \DeclareMathSymbol{\mst@nu}     {\mathalpha}{mteulervm}{"17}
  \DeclareMathSymbol{\mst@xi}     {\mathalpha}{mteulervm}{"18}
  \DeclareMathSymbol{\mst@omicron}{\mathalpha}{mteulervm}{"6F}
  \DeclareMathSymbol{\mst@pi}     {\mathalpha}{mteulervm}{"19}
  \DeclareMathSymbol{\mst@rho}    {\mathalpha}{mteulervm}{"1A}
  \DeclareMathSymbol{\mst@sigma}  {\mathalpha}{mteulervm}{"1B}
  \DeclareMathSymbol{\mst@tau}    {\mathalpha}{mteulervm}{"1C}
  \DeclareMathSymbol{\mst@upsilon}{\mathalpha}{mteulervm}{"1D}
  \DeclareMathSymbol{\mst@phi}    {\mathalpha}{mteulervm}{"1E}
  \DeclareMathSymbol{\mst@chi}    {\mathalpha}{mteulervm}{"1F}
  \DeclareMathSymbol{\mst@psi}    {\mathalpha}{mteulervm}{"20}
  \DeclareMathSymbol{\mst@omega}  {\mathalpha}{mteulervm}{"21}
  \DeclareMathSymbol{\mst@varepsilon}{\mathalpha}{mteulervm}{"22}
  \DeclareMathSymbol{\mst@vartheta}{\mathalpha}{mteulervm}{"23}
  \DeclareMathSymbol{\mst@varpi}  {\mathalpha}{mteulervm}{"24}
  \let\mst@varrho=\mst@rho
  \let\mst@varsigma=\mst@sigma
  \DeclareMathSymbol{\mst@varphi} {\mathalpha}{mteulervm}{"27}
  \DeclareMathSymbol{\mst@partial}{\mathalpha}{mteulervm}{"40}
  \DeclareMathSymbol{\mst@wp}{\mathalpha}{mteulervm}{"7D}
  \DeclareMathSymbol{\mst@ell}{\mathalpha}{mteulervm}{"60}
 \else
  \ifmst@symbolgreek
  \DeclareMathSymbol{\mst@alpha}{\mathord}{mtpsymbol}{"61}
  \DeclareMathSymbol{\mst@beta}{\mathord}{mtpsymbol}{"62}
  \DeclareMathSymbol{\mst@gamma}{\mathord}{mtpsymbol}{"67}
  \DeclareMathSymbol{\mst@delta}{\mathord}{mtpsymbol}{"64}
  \DeclareMathSymbol{\mst@epsilon}{\mathord}{mtpsymbol}{"65}
  \DeclareMathSymbol{\mst@zeta}{\mathord}{mtpsymbol}{"7A}
  \DeclareMathSymbol{\mst@eta}{\mathord}{mtpsymbol}{"68}
  \DeclareMathSymbol{\mst@theta}{\mathord}{mtpsymbol}{"71}
  \DeclareMathSymbol{\mst@iota}{\mathord}{mtpsymbol}{"69}
  \DeclareMathSymbol{\mst@kappa}{\mathord}{mtpsymbol}{"6B}
  \DeclareMathSymbol{\mst@lambda}{\mathord}{mtpsymbol}{"6C}
  \DeclareMathSymbol{\mst@mu}{\mathord}{mtpsymbol}{"6D}
  \DeclareMathSymbol{\mst@nu}{\mathord}{mtpsymbol}{"6E}
  \DeclareMathSymbol{\mst@xi}{\mathord}{mtpsymbol}{"78}
  \DeclareMathSymbol{\mst@omicron}{\mathord}{mtpsymbol}{"6F}
  \DeclareMathSymbol{\mst@pi}{\mathord}{mtpsymbol}{"70}
  \DeclareMathSymbol{\mst@rho}{\mathord}{mtpsymbol}{"72}
  \DeclareMathSymbol{\mst@sigma}{\mathord}{mtpsymbol}{"73}
  \DeclareMathSymbol{\mst@tau}{\mathord}{mtpsymbol}{"74}
  \DeclareMathSymbol{\mst@upsilon}{\mathord}{mtpsymbol}{"75}
  \DeclareMathSymbol{\mst@phi}{\mathord}{mtpsymbol}{"66}
  \DeclareMathSymbol{\mst@chi}{\mathord}{mtpsymbol}{"63}
  \DeclareMathSymbol{\mst@psi}{\mathord}{mtpsymbol}{"79}
  \DeclareMathSymbol{\mst@omega}{\mathord}{mtpsymbol}{"77}
  \let\mst@varepsilon=\mst@epsilon
  \DeclareMathSymbol{\mst@vartheta}{\mathord}{mtpsymbol}{"4A}
  \DeclareMathSymbol{\mst@varpi}{\mathord}{mtpsymbol}{"76}
  \let\mst@varrho=\mst@rho
  \DeclareMathSymbol{\mst@varsigma}{\mathord}{mtpsymbol}{"56}
  \DeclareMathSymbol{\mst@varphi}{\mathord}{mtpsymbol}{"6A}
  \DeclareMathSymbol{\mst@partial}{\mathord}{mtpsymbol}{"B6}
  \DeclareMathSymbol{\mst@wp}{\mathord}{mtpsymbol}{"C3}
  \fi
 \fi
\fi
\ifmst@LGRgreek
  \DeclareMathSymbol{\Alphaup}{\mathalpha}{mtgreekup}{65}
  \DeclareMathSymbol{\Betaup}{\mathalpha}{mtgreekup}{66}
  \DeclareMathSymbol{\Epsilonup}{\mathalpha}{mtgreekup}{69}
  \DeclareMathSymbol{\Zetaup}{\mathalpha}{mtgreekup}{90}
  \DeclareMathSymbol{\Etaup}{\mathalpha}{mtgreekup}{72}
  \DeclareMathSymbol{\Iotaup}{\mathalpha}{mtgreekup}{73}
  \DeclareMathSymbol{\Kappaup}{\mathalpha}{mtgreekup}{75}
  \DeclareMathSymbol{\Muup}{\mathalpha}{mtgreekup}{77}
  \DeclareMathSymbol{\Nuup}{\mathalpha}{mtgreekup}{78}
  \DeclareMathSymbol{\Omicronup}{\mathalpha}{mtgreekup}{79}
  \DeclareMathSymbol{\Rhoup}{\mathalpha}{mtgreekup}{82}
  \DeclareMathSymbol{\Tauup}{\mathalpha}{mtgreekup}{84}
  \DeclareMathSymbol{\Chiup}{\mathalpha}{mtgreekup}{81}
  %
  \DeclareMathSymbol{\Alphait}{\mathalpha}{mtgreekit}{65}
  \DeclareMathSymbol{\Betait}{\mathalpha}{mtgreekit}{66}
  \DeclareMathSymbol{\Epsilonit}{\mathalpha}{mtgreekit}{69}
  \DeclareMathSymbol{\Zetait}{\mathalpha}{mtgreekit}{90}
  \DeclareMathSymbol{\Etait}{\mathalpha}{mtgreekit}{72}
  \DeclareMathSymbol{\Iotait}{\mathalpha}{mtgreekit}{73}
  \DeclareMathSymbol{\Kappait}{\mathalpha}{mtgreekit}{75}
  \DeclareMathSymbol{\Muit}{\mathalpha}{mtgreekit}{77}
  \DeclareMathSymbol{\Nuit}{\mathalpha}{mtgreekit}{78}
  \DeclareMathSymbol{\Omicronit}{\mathalpha}{mtgreekit}{79}
  \DeclareMathSymbol{\Rhoit}{\mathalpha}{mtgreekit}{82}
  \DeclareMathSymbol{\Tauit}{\mathalpha}{mtgreekit}{84}
  \DeclareMathSymbol{\Chiit}{\mathalpha}{mtgreekit}{81}
  \DeclareMathSymbol{\Digammaup}{\mathalpha}{mtgreekup}{195}
  \DeclareMathSymbol{\Digammait}{\mathalpha}{mtgreekit}{195}
  %
  \DeclareMathSymbol{\Gammaup}{\mathalpha}{mtgreekup}{71}
  \DeclareMathSymbol{\Deltaup}{\mathalpha}{mtgreekup}{68}
  \DeclareMathSymbol{\Thetaup}{\mathalpha}{mtgreekup}{74}
  \DeclareMathSymbol{\Lambdaup}{\mathalpha}{mtgreekup}{76}
  \DeclareMathSymbol{\Xiup}{\mathalpha}{mtgreekup}{88}
  \DeclareMathSymbol{\Piup}{\mathalpha}{mtgreekup}{80}
  \DeclareMathSymbol{\Sigmaup}{\mathalpha}{mtgreekup}{83}
  \DeclareMathSymbol{\Upsilonup}{\mathalpha}{mtgreekup}{85}
  \DeclareMathSymbol{\Phiup}{\mathalpha}{mtgreekup}{70}
  \DeclareMathSymbol{\Psiup}{\mathalpha}{mtgreekup}{89}
  \DeclareMathSymbol{\Omegaup}{\mathalpha}{mtgreekup}{87}
  %
  \DeclareMathSymbol{\Gammait}{\mathalpha}{mtgreekit}{71}
  \DeclareMathSymbol{\Deltait}{\mathalpha}{mtgreekit}{68}
  \DeclareMathSymbol{\Thetait}{\mathalpha}{mtgreekit}{74}
  \DeclareMathSymbol{\Lambdait}{\mathalpha}{mtgreekit}{76}
  \DeclareMathSymbol{\Xiit}{\mathalpha}{mtgreekit}{88}
  \DeclareMathSymbol{\Piit}{\mathalpha}{mtgreekit}{80}
  \DeclareMathSymbol{\Sigmait}{\mathalpha}{mtgreekit}{83}
  \DeclareMathSymbol{\Upsilonit}{\mathalpha}{mtgreekit}{85}
  \DeclareMathSymbol{\Phiit}{\mathalpha}{mtgreekit}{70}
  \DeclareMathSymbol{\Psiit}{\mathalpha}{mtgreekit}{89}
  \DeclareMathSymbol{\Omegait}{\mathalpha}{mtgreekit}{87}
  %
  \def\mst@Alpha{\ifmst@greek@upper@up\Alphaup\else\Alphait\fi}%
  \def\mst@Beta{\ifmst@greek@upper@up\Betaup\else\Betait\fi}%
  \def\mst@Epsilon{\ifmst@greek@upper@up\Epsilonup\else\Epsilonit\fi}%
  \def\mst@Zeta{\ifmst@greek@upper@up\Zetaup\else\Zetait\fi}%
  \def\mst@Eta{\ifmst@greek@upper@up\Etaup\else\Etait\fi}%
  \def\mst@Iota{\ifmst@greek@upper@up\Iotaup\else\Iotait\fi}%
  \def\mst@Kappa{\ifmst@greek@upper@up\Kappaup\else\Kappait\fi}%
  \def\mst@Mu{\ifmst@greek@upper@up\Muup\else\Muit\fi}%
  \def\mst@Nu{\ifmst@greek@upper@up\Nuup\else\Nuit\fi}%
  \def\mst@Omicron{\ifmst@greek@upper@up\Omicronup\else\Omicronit\fi}%
  \def\mst@Rho{\ifmst@greek@upper@up\Rhoup\else\Rhoit\fi}%
  \def\mst@Tau{\ifmst@greek@upper@up\Tauup\else\Tauit\fi}%
  \def\mst@Chi{\ifmst@greek@upper@up\Chiup\else\Chiit\fi}%
  %
  \def\mst@Digamma{\ifmst@greek@upper@up\Digammaup\else\Digammait\fi}%
  %
  \def\mst@Gamma{\ifmst@greek@upper@up\Gammaup\else\Gammait\fi}%
  \def\mst@Delta{\ifmst@greek@upper@up\Deltaup\else\Deltait\fi}%
  \def\mst@Theta{\ifmst@greek@upper@up\Thetaup\else\Thetait\fi}%
  \def\mst@Lambda{\ifmst@greek@upper@up\Lambdaup\else\Lambdait\fi}%
  \def\mst@Xi{\ifmst@greek@upper@up\Xiup\else\Xiit\fi}%
  \def\mst@Pi{\ifmst@greek@upper@up\Piup\else\Piit\fi}%
  \def\mst@Sigma{\ifmst@greek@upper@up\Sigmaup\else\Sigmait\fi}%
  \def\mst@Upsilon{\ifmst@greek@upper@up\Upsilonup\else\Upsilonit\fi}%
  \def\mst@Phi{\ifmst@greek@upper@up\Phiup\else\Phiit\fi}%
  \def\mst@Psi{\ifmst@greek@upper@up\Psiup\else\Psiit\fi}%
  \def\mst@Omega{\ifmst@greek@upper@up\Omegaup\else\Omegait\fi}%
  %
  \DeclareMathSymbol{\alphaup}{\mathalpha}{mtgreekup}{97}
  \DeclareMathSymbol{\betaup}{\mathalpha}{mtgreekup}{98}
  \DeclareMathSymbol{\gammaup}{\mathalpha}{mtgreekup}{103}
  \DeclareMathSymbol{\deltaup}{\mathalpha}{mtgreekup}{100}
  \DeclareMathSymbol{\epsilonup}{\mathalpha}{mtgreekup}{101}
  \DeclareMathSymbol{\zetaup}{\mathalpha}{mtgreekup}{122}
  \DeclareMathSymbol{\etaup}{\mathalpha}{mtgreekup}{104}
  \DeclareMathSymbol{\thetaup}{\mathalpha}{mtgreekup}{106}
  \DeclareMathSymbol{\iotaup}{\mathalpha}{mtgreekup}{105}
  \DeclareMathSymbol{\kappaup}{\mathalpha}{mtgreekup}{107}
  \DeclareMathSymbol{\lambdaup}{\mathalpha}{mtgreekup}{108}
  \DeclareMathSymbol{\muup}{\mathalpha}{mtgreekup}{109}
  \DeclareMathSymbol{\nuup}{\mathalpha}{mtgreekup}{110}
  \DeclareMathSymbol{\xiup}{\mathalpha}{mtgreekup}{120}
  \DeclareMathSymbol{\omicronup}{\mathalpha}{mtgreekup}{111}
  \DeclareMathSymbol{\piup}{\mathalpha}{mtgreekup}{112}
  \DeclareMathSymbol{\rhoup}{\mathalpha}{mtgreekup}{114}
  \DeclareMathSymbol{\sigmaup}{\mathalpha}{mtgreekup}{115}
  \DeclareMathSymbol{\tauup}{\mathalpha}{mtgreekup}{116}
  \DeclareMathSymbol{\upsilonup}{\mathalpha}{mtgreekup}{117}
  \DeclareMathSymbol{\phiup}{\mathalpha}{mtgreekup}{102}
  \DeclareMathSymbol{\chiup}{\mathalpha}{mtgreekup}{113}
  \DeclareMathSymbol{\psiup}{\mathalpha}{mtgreekup}{121}
  \DeclareMathSymbol{\omegaup}{\mathalpha}{mtgreekup}{119}
  %
  \DeclareMathSymbol{\digammaup}{\mathalpha}{mtgreekup}{147}
  \DeclareMathSymbol{\varsigmaup}{\mathalpha}{mtgreekup}{99}
  %
  \DeclareMathSymbol{\alphait}{\mathalpha}{mtgreekit}{97}
  \DeclareMathSymbol{\betait}{\mathalpha}{mtgreekit}{98}
  \DeclareMathSymbol{\gammait}{\mathalpha}{mtgreekit}{103}
  \DeclareMathSymbol{\deltait}{\mathalpha}{mtgreekit}{100}
  \DeclareMathSymbol{\epsilonit}{\mathalpha}{mtgreekit}{101}
  \DeclareMathSymbol{\zetait}{\mathalpha}{mtgreekit}{122}
  \DeclareMathSymbol{\etait}{\mathalpha}{mtgreekit}{104}
  \DeclareMathSymbol{\thetait}{\mathalpha}{mtgreekit}{106}
  \DeclareMathSymbol{\iotait}{\mathalpha}{mtgreekit}{105}
  \DeclareMathSymbol{\kappait}{\mathalpha}{mtgreekit}{107}
  \DeclareMathSymbol{\lambdait}{\mathalpha}{mtgreekit}{108}
  \DeclareMathSymbol{\muit}{\mathalpha}{mtgreekit}{109}
  \DeclareMathSymbol{\nuit}{\mathalpha}{mtgreekit}{110}
  \DeclareMathSymbol{\xiit}{\mathalpha}{mtgreekit}{120}
  \DeclareMathSymbol{\omicronit}{\mathalpha}{mtgreekit}{111}
  \DeclareMathSymbol{\piit}{\mathalpha}{mtgreekit}{112}
  \DeclareMathSymbol{\rhoit}{\mathalpha}{mtgreekit}{114}
  \DeclareMathSymbol{\sigmait}{\mathalpha}{mtgreekit}{115}
  \DeclareMathSymbol{\tauit}{\mathalpha}{mtgreekit}{116}
  \DeclareMathSymbol{\upsilonit}{\mathalpha}{mtgreekit}{117}
  \DeclareMathSymbol{\phiit}{\mathalpha}{mtgreekit}{102}
  \DeclareMathSymbol{\chiit}{\mathalpha}{mtgreekit}{113}
  \DeclareMathSymbol{\psiit}{\mathalpha}{mtgreekit}{121}
  \DeclareMathSymbol{\omegait}{\mathalpha}{mtgreekit}{119}
  %
  \DeclareMathSymbol{\digammait}{\mathalpha}{mtgreekit}{147}
  \DeclareMathSymbol{\varsigmait}{\mathalpha}{mtgreekit}{99}
  %
  \def\mst@alpha{\ifmst@greek@lower@up\alphaup\else\alphait\fi}%
  \def\mst@beta{\ifmst@greek@lower@up\betaup\else\betait\fi}%
  \def\mst@gamma{\ifmst@greek@lower@up\gammaup\else\gammait\fi}%
  \def\mst@delta{\ifmst@greek@lower@up\deltaup\else\deltait\fi}%
  \def\mst@epsilon{\ifmst@greek@lower@up\epsilonup\else\epsilonit\fi}%
  \def\mst@zeta{\ifmst@greek@lower@up\zetaup\else\zetait\fi}%
  \def\mst@eta{\ifmst@greek@lower@up\etaup\else\etait\fi}%
  \def\mst@theta{\ifmst@greek@lower@up\thetaup\else\thetait\fi}%
  \def\mst@iota{\ifmst@greek@lower@up\iotaup\else\iotait\fi}%
  \def\mst@kappa{\ifmst@greek@lower@up\kappaup\else\kappait\fi}%
  \def\mst@lambda{\ifmst@greek@lower@up\lambdaup\else\lambdait\fi}%
  \def\mst@mu{\ifmst@greek@lower@up\muup\else\muit\fi}%
  \def\mst@nu{\ifmst@greek@lower@up\nuup\else\nuit\fi}%
  \def\mst@xi{\ifmst@greek@lower@up\xiup\else\xiit\fi}%
  \def\mst@omicron{\ifmst@greek@lower@up\omicronup\else\omicronit\fi}%
  \def\mst@pi{\ifmst@greek@lower@up\piup\else\piit\fi}%
  \def\mst@rho{\ifmst@greek@lower@up\rhoup\else\rhoit\fi}%
  \def\mst@sigma{\ifmst@greek@lower@up\sigmaup\else\sigmait\fi}%
  \def\mst@tau{\ifmst@greek@lower@up\tauup\else\tauit\fi}%
  \def\mst@upsilon{\ifmst@greek@lower@up\upsilonup\else\upsilonit\fi}%
  \def\mst@phi{\ifmst@greek@lower@up\phiup\else\phiit\fi}%
  \def\mst@chi{\ifmst@greek@lower@up\chiup\else\chiit\fi}%
  \def\mst@psi{\ifmst@greek@lower@up\psiup\else\psiit\fi}%
  \def\mst@omega{\ifmst@greek@lower@up\omegaup\else\omegait\fi}%
    %
  \def\mst@digamma{\ifmst@greek@lower@up\digammaup\else\digammait\fi}%
  \def\mst@varsigma{\ifmst@greek@lower@up\varsigmaup\else\varsigmait\fi}%
\fi
\newcommand*{\MTstandardgreek}{}
\newcommand*{\MTcustomgreek}{}
\newcommand*{\MTrecordstandardgreek}{}
\ifmst@customgreek
 \renewcommand*{\MTrecordstandardgreek}{%
    \let\mst@origAlpha\Alpha
    \let\mst@origBeta\Beta
    \let\mst@origGamma\Gamma
    \let\mst@origDelta\Delta
    \let\mst@origEpsilon\Epsilon
    \let\mst@origZeta\Zeta
    \let\mst@origEta\Eta
    \let\mst@origTheta\Theta
    \let\mst@origIota\Iota
    \let\mst@origKappa\Kappa
    \let\mst@origLambda\Lambda
    \let\mst@origMu\Mu
    \let\mst@origNu\Nu
    \let\mst@origXi\Xi
    \let\mst@origOmicron\Omicron
    \let\mst@origPi\Pi
    \let\mst@origRho\Rho
    \let\mst@origSigma\Sigma
    \let\mst@origTau\Tau
    \let\mst@origUpsilon\Upsilon
    \let\mst@origPhi\Phi
    \let\mst@origChi\Chi
    \let\mst@origPsi\Psi
    \let\mst@origOmega\Omega
    \let\mst@origalpha\alpha
    \let\mst@origbeta\beta
    \let\mst@origgamma\gamma
    \let\mst@origdelta\delta
    \let\mst@origepsilon\epsilon
    \let\mst@origvarepsilon\varepsilon
    \let\mst@origzeta\zeta
    \let\mst@origeta\eta
    \let\mst@origtheta\theta
    \let\mst@origvartheta\vartheta
    \let\mst@origiota\iota
    \let\mst@origkappa\kappa
    \let\mst@origlambda\lambda
    \let\mst@origmu\mu
    \let\mst@orignu\nu
    \let\mst@origxi\xi
    \let\mst@origomicron\omicron
    \let\mst@origpi\pi
    \let\mst@origvarpi\varpi
    \let\mst@origrho\rho
    \let\mst@origvarrho\varrho
    \let\mst@origsigma\sigma
    \let\mst@origvarsigma\varsigma
    \let\mst@origtau\tau
    \let\mst@origupsilon\upsilon
    \let\mst@origphi\phi
    \let\mst@origvarphi\varphi
    \let\mst@origchi\chi
    \let\mst@origpsi\psi
    \let\mst@origomega\omega
    \let\mst@origDigamma\Digamma
    \let\mst@origdigamma\digamma
    \let\mst@origpartial\partial
    \let\mst@origwp\wp
    \let\mst@origell\ell }%
\MTrecordstandardgreek
\renewcommand*{\MTstandardgreek}{%
    \let\Alpha\mst@origAlpha
    \let\Beta\mst@origBeta
    \let\Gamma\mst@origGamma
    \let\Delta\mst@origDelta
    \let\Epsilon\mst@origEpsilon
    \let\Zeta\mst@origZeta
    \let\Eta\mst@origEta
    \let\Theta\mst@origTheta
    \let\Iota\mst@origIota
    \let\Kappa\mst@origKappa
    \let\Lambda\mst@origLambda
    \let\Mu\mst@origMu
    \let\Nu\mst@origNu
    \let\Xi\mst@origXi
    \let\Omicron\mst@origOmicron
    \let\Pi\mst@origPi
    \let\Rho\mst@origRho
    \let\Sigma\mst@origSigma
    \let\Tau\mst@origTau
    \let\Upsilon\mst@origUpsilon
    \let\Phi\mst@origPhi
    \let\Chi\mst@origChi
    \let\Psi\mst@origPsi
    \let\Omega\mst@origOmega
    \let\alpha\mst@origalpha
    \let\beta\mst@origbeta
    \let\gamma\mst@origgamma
    \let\delta\mst@origdelta
    \let\epsilon\mst@origepsilon
    \let\varepsilon\mst@origvarepsilon
    \let\zeta\mst@origzeta
    \let\eta\mst@origeta
    \let\theta\mst@origtheta
    \let\vartheta\mst@origvartheta
    \let\iota\mst@origiota
    \let\kappa\mst@origkappa
    \let\lambda\mst@origlambda
    \let\mu\mst@origmu
    \let\nu\mst@orignu
    \let\xi\mst@origxi
    \let\omicron\mst@origomicron
    \let\pi\mst@origpi
    \let\varpi\mst@origvarpi
    \let\rho\mst@origrho
    \let\varrho\mst@origvarrho
    \let\sigma\mst@origsigma
    \let\varsigma\mst@origvarsigma
    \let\tau\mst@origtau
    \let\upsilon\mst@origupsilon
    \let\phi\mst@origphi
    \let\varphi\mst@origvarphi
    \let\chi\mst@origchi
    \let\psi\mst@origpsi
    \let\omega\mst@origomega
    \let\Digamma\mst@origDigamma
    \let\digamma\mst@origdigamma
    \let\partial\mst@origpartial
    \let\wp\mst@origwp
    \let\ell\mst@origell
}%
\ifmst@greekplus
\def\mst@define@lowergreekletter#1#2{%
    \protected\def#1{\ifcase\mst@mathalph
        \ifmst@greek@lower@up\mathgreekup{#2}\else\mathgreekit{#2}\fi
      \or % rm
        \mathgreekup{#2}%
      \or % bf
        \mathgreekupbold{#2}%
      \or % it
        \mathgreekit{#2}%
      \or % normalbold
        \ifmst@greek@lower@up\mathgreekupbold{#2}\else\mathgreekitbold{#2}\fi
      \else #2\fi}%
    }
\def\mst@define@uppergreekletter#1#2{%
    \protected\def#1{\ifcase\mst@mathalph
        \ifmst@greek@upper@up\mathgreekup{#2}\else\mathgreekit{#2}\fi
      \or % rm
        \mathgreekup{#2}%
      \or % bf
        \mathgreekupbold{#2}%
      \or % it
        \mathgreekit{#2}%
      \or % mathnormalbold
        \ifmst@greek@upper@up\mathgreekupbold{#2}\else\mathgreekitbold{#2}\fi
      \else #2\fi}%
    }
\renewcommand*{\MTcustomgreek}{%
    \mst@define@uppergreekletter\Alpha\mst@Alpha
    \mst@define@uppergreekletter\Beta\mst@Beta
    \mst@define@uppergreekletter\Epsilon\mst@Epsilon
    \mst@define@uppergreekletter\Zeta\mst@Zeta
    \mst@define@uppergreekletter\Eta\mst@Eta
    \mst@define@uppergreekletter\Iota\mst@Iota
    \mst@define@uppergreekletter\Kappa\mst@Kappa
    \mst@define@uppergreekletter\Mu\mst@Mu
    \mst@define@uppergreekletter\Nu\mst@Nu
    \mst@define@uppergreekletter\Omicron\mst@Omicron
    \mst@define@uppergreekletter\Rho\mst@Rho
    \mst@define@uppergreekletter\Tau\mst@Tau
    \mst@define@uppergreekletter\Chi\mst@Chi
    \mst@define@uppergreekletter\Digamma\mst@Digamma
    \mst@define@uppergreekletter\Gamma\mst@Gamma
    \mst@define@uppergreekletter\Delta\mst@Delta
    \mst@define@uppergreekletter\Theta\mst@Theta
    \mst@define@uppergreekletter\Lambda\mst@Lambda
    \mst@define@uppergreekletter\Xi\mst@Xi
    \mst@define@uppergreekletter\Pi\mst@Pi
    \mst@define@uppergreekletter\Sigma\mst@Sigma
    \mst@define@uppergreekletter\Upsilon\mst@Upsilon
    \mst@define@uppergreekletter\Phi\mst@Phi
    \mst@define@uppergreekletter\Psi\mst@Psi
    \mst@define@uppergreekletter\Omega\mst@Omega
    \mst@define@lowergreekletter\alpha\mst@alpha
    \mst@define@lowergreekletter\beta\mst@beta
    \mst@define@lowergreekletter\gamma\mst@gamma
    \mst@define@lowergreekletter\delta\mst@delta
    \mst@define@lowergreekletter\epsilon\mst@epsilon
    \mst@define@lowergreekletter\zeta\mst@zeta
    \mst@define@lowergreekletter\eta\mst@eta
    \mst@define@lowergreekletter\theta\mst@theta
    \mst@define@lowergreekletter\iota\mst@iota
    \mst@define@lowergreekletter\kappa\mst@kappa
    \mst@define@lowergreekletter\lambda\mst@lambda
    \mst@define@lowergreekletter\mu\mst@mu
    \mst@define@lowergreekletter\nu\mst@nu
    \mst@define@lowergreekletter\xi\mst@xi
    \mst@define@lowergreekletter\omicron\mst@omicron
    \mst@define@lowergreekletter\pi\mst@pi
    \mst@define@lowergreekletter\rho\mst@rho
    \mst@define@lowergreekletter\sigma\mst@sigma
    \mst@define@lowergreekletter\tau\mst@tau
    \mst@define@lowergreekletter\upsilon\mst@upsilon
    \mst@define@lowergreekletter\phi\mst@phi
    \mst@define@lowergreekletter\chi\mst@chi
    \mst@define@lowergreekletter\psi\mst@psi
    \mst@define@lowergreekletter\omega\mst@omega
    \mst@define@lowergreekletter\varsigma\mst@varsigma
    \mst@define@lowergreekletter\digamma\mst@digamma
}%
\else
\renewcommand*{\MTcustomgreek}{%
  \expanded{%
    \let\noexpand\Alpha\mst@Alpha
    \let\noexpand\Beta\mst@Beta
    \let\noexpand\Epsilon\mst@Epsilon
    \let\noexpand\Zeta\mst@Zeta
    \let\noexpand\Eta\mst@Eta
    \let\noexpand\Iota\mst@Iota
    \let\noexpand\Kappa\mst@Kappa
    \let\noexpand\Mu\mst@Mu
    \let\noexpand\Nu\mst@Nu
    \let\noexpand\Omicron\mst@Omicron
    \let\noexpand\Rho\mst@Rho
    \let\noexpand\Tau\mst@Tau
    \let\noexpand\Chi\mst@Chi
  }%
    \ifmst@symbolgreek\else
        \expanded{\let\noexpand\Digamma\mst@Digamma}%
    \fi
  \expanded{%
    \let\noexpand\Gamma\mst@Gamma
    \let\noexpand\Delta\mst@Delta
    \let\noexpand\Theta\mst@Theta
    \let\noexpand\Lambda\mst@Lambda
    \let\noexpand\Xi\mst@Xi
    \let\noexpand\Pi\mst@Pi
    \let\noexpand\Sigma\mst@Sigma
    \let\noexpand\Upsilon\mst@Upsilon
    \let\noexpand\Phi\mst@Phi
    \let\noexpand\Psi\mst@Psi
    \let\noexpand\Omega\mst@Omega
  }%
 \ifmst@selfGreek\else
  \expanded{%
    \let\noexpand\alpha\mst@alpha
    \let\noexpand\beta\mst@beta
    \let\noexpand\gamma\mst@gamma
    \let\noexpand\delta\mst@delta
    \let\noexpand\epsilon\mst@epsilon
    \let\noexpand\zeta\mst@zeta
    \let\noexpand\eta\mst@eta
    \let\noexpand\theta\mst@theta
    \let\noexpand\iota\mst@iota
    \let\noexpand\kappa\mst@kappa
    \let\noexpand\lambda\mst@lambda
    \let\noexpand\mu\mst@mu
    \let\noexpand\nu\mst@nu
    \let\noexpand\xi\mst@xi
    \let\noexpand\omicron\mst@omicron
    \let\noexpand\pi\mst@pi
    \let\noexpand\rho\mst@rho
    \let\noexpand\sigma\mst@sigma
    \let\noexpand\tau\mst@tau
    \let\noexpand\upsilon\mst@upsilon
    \let\noexpand\phi\mst@phi
    \let\noexpand\chi\mst@chi
    \let\noexpand\psi\mst@psi
    \let\noexpand\omega\mst@omega
    \let\noexpand\varsigma\mst@varsigma
  }%
    \ifmst@LGRgreek
        \expanded{\let\noexpand\digamma\mst@digamma}%
    \fi
    \ifmst@LGRgreek\else
      \let\varepsilon\mst@varepsilon
      \let\vartheta\mst@vartheta
      \let\varpi\mst@varpi
      \let\varrho\mst@varrho
      \let\varphi\mst@varphi
      \let\partial\mst@partial
      \let\wp\mst@wp
      \ifmst@symbolgreek\else\let\ell\mst@ell\fi
    \fi
 \fi
}%
\fi
\fi
\let\Mathastextstandardgreek\MTstandardgreek
\let\Mathastextcustomgreek\MTcustomgreek
\ifmst@subdued\else\MTcustomgreek\fi
\let\mst@subduedinodot\@empty
\let\mst@nonsubduedinodot\@empty
\ifmst@noletters
\else
\def\mst@subduedinodot{%
   \let\inodot\mst@original@imath
   \let\jnodot\mst@original@jmath
}%
\def\mst@nonsubduedinodot{%
   \expandafter\let\expandafter\inodot
               \csname mst@inodot@mv\math@version\endcsname
   \expandafter\let\expandafter\jnodot
               \csname mst@jnodot@mv\math@version\endcsname
   \ifx\inodot\relax\let\inodot\mst@original@imath\fi
   \ifx\jnodot\relax\let\jnodot\mst@original@jmath\fi
}%
\fi
\def\mst@dothe@inodotstuff#1#2#3#4{%
  \edef\mst@tmp@enc{#3}%
  \if1\mst@OneifUniEnc
    \mst@Umathchardef#1="7 \symmtletterfont "0131 \relax
    \mst@Umathchardef#2="7 \symmtletterfont "0237 \relax
  \else
    \@ifundefined{\mst@tmp@enc\string\i}%
        {%
          \PackageWarningNoLine{mathastext}
          {Impossible to define the \string\inodot\space using a font with\MessageBreak
           \mst@tmp@enc\space encoding, as there is no \string\i.\MessageBreak
           Reverting to default \string\imath\space in math version #4}%
          \let#1\relax
        }%
        {%
          \DeclareMathSymbol{#1}{\mathalpha}{mtletterfont}
                            {\csname\mst@tmp@enc\string\i\endcsname}%
        }%
    \@ifundefined{\mst@tmp@enc\string\j}%
        {%
          \PackageWarningNoLine{mathastext}
          {Impossible to define the \string\jnodot\space using a font with\MessageBreak
           \mst@tmp@enc\space encoding, as there is no \string\j.\MessageBreak
           Reverting to default \string\jmath\space in math version #4}%
          \let#2\relax
        }%
        {%
          \DeclareMathSymbol{#2}{\mathalpha}{mtletterfont}
                            {\csname\mst@tmp@enc\string\j\endcsname}%
        }%
  \fi
}%
\ifmst@defaultimath\else\mst@infoline{\string\imath\space and \string\jmath\space}
    \AtEndOfPackage{\AtBeginDocument{%
        \protected\def\imath{\inodot}%
        \protected\def\jmath{\jnodot}%
    }}%
\fi
\let\mst@subduedmathaccents\@empty
\let\mst@nonsubduedmathaccents\@empty
\ifmst@mathaccents
\def\mst@subduedmathaccents{%
  \@tfor\@tempa:={grave}{acute}{check}{breve}{bar}%
                 {dot}{ddot}{mathring}{hat}{tilde}%
  \do
  {\expandafter\let\csname\@tempa\expandafter\endcsname
                   \csname mst@original@\@tempa\endcsname
   \expandafter\let\csname\@tempa\space\expandafter\endcsname
                   \csname mst@original@\@tempa\space\endcsname
  }%
}%
\def\mst@nonsubduedmathaccents{%
 \@ifundefined{mst@grave@mv\math@version}
 {\mst@subduedmathaccents}
 {%
  \@tfor\@tempa:={grave}{acute}{check}{breve}{bar}%
                 {dot}{ddot}{mathring}{hat}{tilde}%
  \do
  {\expandafter\let\csname\@tempa\expandafter\endcsname
                   \csname mst@\@tempa @mv\math@version\endcsname
   \expandafter\let\csname\@tempa\space\expandafter\endcsname
                   \csname mst@\@tempa @mv\math@version\space\endcsname
  }%
 }%
}%
\def\mst@dothe@mathaccentsstuff#1#2{%
  \begingroup
  \edef\mst@tmp@enc{#2}%
  \def\@text@composite##1\@text@composite##2{##2}%
  \let\add@accent\@firstoftwo
  \let\add@unicode@accent\@firstoftwo
  \if1\mst@OneifUniEnc
    \ifmst@unimathaccents
      \expandafter\xdef\csname mst@grave@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\`\endcsname{}\relax}%
      \expandafter\xdef\csname mst@acute@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\'\endcsname{}\relax}%
      \expandafter\xdef\csname mst@check@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\v\endcsname{}\relax}%
      \expandafter\xdef\csname mst@breve@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\u\endcsname{}\relax}%
      \expandafter\xdef\csname mst@bar@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\=\endcsname{}\relax}%
      \expandafter\xdef\csname mst@dot@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\.\endcsname{}\relax}%
      \expandafter\xdef\csname mst@ddot@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\"\endcsname{}\relax}%
      \expandafter\xdef\csname mst@mathring@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\r\endcsname{}\relax}%
      \expandafter\xdef\csname mst@hat@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\^\endcsname{}\relax}%
      \expandafter\xdef\csname mst@tilde@mv#1 \endcsname
       {\mst@Umathaccent
        7
        \number\symmtoperatorfont\space
        \csname#2\string\~\endcsname{}\relax}%
    \else
      \AtEndOfPackage{\AtBeginDocument{%
      \@tfor\@tempa:={grave}{acute}{check}{breve}{bar}%
                     {dot}{ddot}{mathring}{hat}{tilde}%
      \do
      {\expandafter\let
          \csname mst@\@tempa @mv#1\expandafter\endcsname
          \csname mst@original@\@tempa\endcsname
       \expandafter\let
          \csname mst@\@tempa @mv#1\space\expandafter\endcsname
          \csname mst@original@\@tempa\space\endcsname}%
      }}%
    \fi
      \@tfor\@tempa:={grave}{acute}{check}{breve}{bar}%
                     {dot}{ddot}{mathring}{hat}{tilde}%
      \do
      {\expandafter\xdef\csname mst@\@tempa @mv#1\endcsname
         {\noexpand\protect
          \expandafter\noexpand\csname mst@\@tempa @mv#1 \endcsname}%
      }%
  \else
   \@ifundefined{#2\string\`}
      {\PackageWarningNoLine{mathastext}
         {Impossible to pick up text accents from an #2\MessageBreak
          encoded font.  The mathaccent option will be\MessageBreak
          ignored for the math version #1}%
       \let\mst@tempa0}
      {\let\mst@tempa1}%
   \if\mst@tempa1%
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@grave@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\`\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@acute@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\'\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@check@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\v\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@breve@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\u\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@bar@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\=\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@dot@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\.\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@ddot@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\"\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@mathring@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\r\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@hat@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\^\endcsname{}}
    \expandafter\mst@DeclareMathAccent\expandafter
               {\csname mst@tilde@mv#1\endcsname}{\mathalpha}{mtoperatorfont}%
               {\csname#2\string\~\endcsname{}}
   \else
    \global\expandafter\let\csname mst@grave@mv#1\endcsname\relax
   \fi
  \fi
  \endgroup
}%
\fi
\newcommand*\MTDeclareVersion[6][]{%
  \edef\mst@declareversionargs{{#1}{#2}{#3}{#4}{#5}{#6}}%
  \edef\mst@version{#2}%
  \if0\ifx\mst@version\mst@normalversionname0\else
      \ifx\mst@version\mst@boldversionname0\else
      1\fi\fi
   \expandafter\expandafter\expandafter
   \MTDoNotDeclareVersion@\expandafter\@gobblefour
  \fi
  \relax\DeclareMathVersion{\mst@version}\MTDeclareVersion@
}%
\newcommand*\MTDoNotDeclareVersion@[1][]{%
   \PackageWarningNoLine{mathastext}{You asked to declare a version with name
   `\mst@version'.^^J%
   \@spaces Sorry but you are not allowed to do that.^^J%
   \@spaces \ifmst@subdued Anyway the `subdued' option is in force\else
         Use rather \string\Mathastext\space macro (with no optional argument)\fi
}}%
\newcommand*\MTDeclareVersion@[1][]{%
    \edef\mst@tmp{#1}%
    \ifx\mst@tmp\empty\else
      \global\expandafter\let\csname mv@\mst@version\expandafter\endcsname
                             \csname mv@#1\endcsname
      \PackageInfo{mathastext}
                  {Math version `\mst@version\string'\MessageBreak
                   declared\on@line\MessageBreak
                   inherits from `#1\string'\@gobble}%
    \fi
    \expandafter\MTDeclareVersion@@\mst@declareversionargs
}%
\newcommand*\MTDeclareVersion@@[6]{%
  \expandafter\edef\csname mst@encoding@\mst@version\endcsname{#3}%
  \expandafter\edef\csname mst@family@\mst@version\endcsname{#4}%
  \expandafter\edef\csname mst@series@\mst@version\endcsname{#5}%
  \expandafter\edef\csname mst@shape@\mst@version\endcsname{#6}%
  \expandafter\edef\csname mst@boldvariant@\mst@version\endcsname{\mst@bold}%
  \expandafter\edef\csname mst@itdefault@\mst@version\endcsname{\itdefault}%
  \expandafter\edef\csname mst@rmdefault@\mst@version\endcsname{\rmdefault}%
  \expandafter\edef\csname mst@sfdefault@\mst@version\endcsname{\sfdefault}%
  \expandafter\edef\csname mst@ttdefault@\mst@version\endcsname{\ttdefault}%
  \expandafter\edef\csname mst@exists@skip@\mst@version\endcsname
        {\mst@exists@skip}%
  \expandafter\edef\csname mst@forall@skip@\mst@version\endcsname
        {\mst@forall@skip}%
  \expandafter\edef\csname mst@prime@skip@\mst@version\endcsname
        {\mst@prime@skip}%
  \def\mst@tmp{#1}%
  \ifx\mst@tmp\empty
    \ifmst@italic
      \SetSymbolFont{mtletterfont}{#2}{#3}{#4}{#5}{\mst@ltsh}%
      \immediate\write\m@ne{}%
      \PackageInfo{mathastext}%
                        {\ifmst@noletters
                         \else
                         Latin letters in math version `#2\string'\MessageBreak
                         declared\on@line\MessageBreak
                         will use the font #3/#4/#5/\mst@ltsh
                         \ifmst@frenchmath\space(uppercase: #6)\fi\MessageBreak
                         \fi
                         Other characters (digits, ...) and \protect\log-like names\MessageBreak
                         \ifmst@noletters
                         will use the font #3/#4/#5/#6%
                         \else
                         will be in `#6\string' shape%
                         \fi\@gobble}%
      \immediate\write\m@ne{}%
      \expandafter\edef\csname mst@ltshape@\mst@version\endcsname{\mst@ltsh}%
    \else
      \SetSymbolFont{mtletterfont}{#2}{#3}{#4}{#5}{#6}%
      \ifmst@noletters
      \else
      \immediate\write\m@ne{}%
      \PackageInfo{mathastext}%
                        {Latin letters in math version `#2\string'\MessageBreak
                         declared\on@line\MessageBreak
                         will use the fonts #3/#4/#5(\mst@bold)/#6\@gobble}%
      \fi
      \immediate\write\m@ne{}%
      \expandafter\edef\csname mst@ltshape@\mst@version\endcsname{#6}%
    \fi
  \else
    \SetSymbolFont{mtletterfont}{#2}{#3}{#4}{#5}{#1}%
    \immediate\write\m@ne{}%
    \PackageInfo{mathastext}%
                        {\ifmst@noletters
                         \else
                         Latin letters in math version `#2\string'\MessageBreak
                         declared\on@line\MessageBreak
                         will use the font #3/#4/#5/#1%
                         \ifmst@frenchmath\space(uppercase: #6)\fi\MessageBreak
                         \fi
                         Other characters (digits, ...) and
                         \protect\log-like names\MessageBreak
                         \ifmst@noletters
                         will use the font #3/#4/#5/#6%
                         \else
                         will be in `#6\string' shape%
                         \fi\@gobble}%
    \immediate\write\m@ne{}%
    \expandafter\edef\csname mst@ltshape@\mst@version\endcsname{#1}%
  \fi
       \SetMathAlphabet{\Mathnormalbold}{#2}{#3}{#4}{\mst@bold}%
                   {\csname mst@ltshape@\mst@version\endcsname}%
  \SetSymbolFont{mtoperatorfont}{#2}{#3}{#4}{#5}{#6}%
  \SetMathAlphabet{\Mathbf}{#2}{#3}{#4}{\mst@bold}{#6}
  \SetMathAlphabet{\Mathit}{#2}{#3}{#4}{#5}{\itdefault}
  \SetMathAlphabet{\Mathsf}{#2}{#3}{\sfdefault}{#5}{#6}
  \SetMathAlphabet{\Mathtt}{#2}{#3}{\ttdefault}{#5}{#6}
  \ifmst@needeuler
      \SetMathAlphabet{\MathEulerBold}{#2}{U}{zeur}{\mst@bold}{n}%
  \fi
  \mst@update@greeksh
     {\csname mst@ltshape@\mst@version\endcsname}%
     {\csname mst@shape@\mst@version\endcsname}%
    \ifmst@LGRgreeks \def\mst@greekfont{#4}\fi
    \ifmst@selfGreeks\def\mst@greekfont{#4}\fi
    \ifmst@LGRgreek
      \SetSymbolFont{mtgreekup}{#2}{LGR}{\mst@greekfont}{#5}{\MTgreekupdefault}%
      \SetSymbolFont{mtgreekit}{#2}{LGR}{\mst@greekfont}{#5}{\MTgreekitdefault}%
      \SetMathAlphabet{\mathgreekupbold}{#2}{LGR}{\mst@greekfont}
                                                 {\mst@bold}{\MTgreekupdefault}%
      \SetMathAlphabet{\mathgreekitbold}{#2}{LGR}{\mst@greekfont}
                                                 {\mst@bold}{\MTgreekitdefault}%
      \expandafter\let\csname ifmst@greek@\mst@version @upper@up\expandafter\endcsname
                      \csname ifmst@greek@upper@up\endcsname
      \expandafter\let\csname ifmst@greek@\mst@version @lower@up\expandafter\endcsname
                      \csname ifmst@greek@lower@up\endcsname
\immediate\write\m@ne{}%
\PackageInfo{mathastext}{Greek letters (upper:
      `\ifmst@greek@upper@up\MTgreekupdefault\else\MTgreekitdefault\fi\string',
                                 lower:
      `\ifmst@greek@lower@up\MTgreekupdefault\else\MTgreekitdefault\fi\string')\MessageBreak
                         will use font family `\mst@greekfont\string' (LGR)\MessageBreak
                         in mathastext
                         math version `\mst@version\string'\MessageBreak
                         declared}%
\immediate\write\m@ne{}%
    \else
     \ifmst@selfGreek
       \SetSymbolFont{mtselfGreekfont}{#2}{OT1}{\mst@greekfont}{#5}{\mst@greek@ush}%
\immediate\write\m@ne{}%
\PackageInfo{mathastext}{Capital Greek letters (shape `\mst@greek@ush\string'
                           will use the font\MessageBreak
                         family `\mst@greekfont\string' (OT1) in mathastext\MessageBreak
                         math version `\mst@version\string' declared}%
\immediate\write\m@ne{}%
     \fi
    \fi
  \ifmst@nohbar\else
    \edef\mst@tmp{\expandafter\noexpand\csname mst@hbar@mv#2\endcsname
                  \expandafter\noexpand\csname mst@ltbar@mv#2\endcsname}%
    \expandafter\mst@dothe@hbarstuff\mst@tmp{#3}{#3}%
  \fi
  \edef\mst@tmp{\expandafter\noexpand\csname mst@inodot@mv#2\endcsname
                \expandafter\noexpand\csname mst@jnodot@mv#2\endcsname}%
  \ifmst@noletters\else
    \expandafter\mst@dothe@inodotstuff\mst@tmp{#3}{#2}%
  \fi
  \ifmst@mathaccents
    \mst@dothe@mathaccentsstuff{#2}{#3}%
  \fi
  \edef\mst@tmp{\expandafter\noexpand\csname mst@minus@mv#2\endcsname
                \expandafter\noexpand\csname mst@varfam@minus@mv#2\endcsname}%
  \ifmst@endash
    \expandafter\mst@dothe@endashstuff\mst@tmp{#3}{#2}%
  \else
    \ifmst@emdash
      \expandafter\mst@dothe@emdashstuff\mst@tmp{#3}{#2}%
    \else
      \expandafter\mst@dothe@hyphenstuff\mst@tmp
    \fi
  \fi
}%
\let\MathastextDeclareVersion\MTDeclareVersion
\newcommand*\MTversion {\@ifstar\MTversion@s\MTversion@}
\newcommand*\MTversion@s [1]{\mathversion{#1}\MTversion@@}
\newcommand*\MTversion@ [2][]{%
    \mathversion{#2}%
    \edef\mst@tmpa{#1}%
    \ifx\mst@tmpa\empty
        \let\mst@tmp\math@version
    \else
        \let\mst@tmp\mst@tmpa
    \fi
    \edef\encodingdefault {\csname mst@encoding@\mst@tmp\endcsname}%
    \edef\familydefault   {\csname mst@family@\mst@tmp\endcsname}%
    \edef\seriesdefault   {\csname mst@series@\mst@tmp\endcsname}%
    \edef\shapedefault    {\csname mst@shape@\mst@tmp\endcsname}%
    \edef\bfdefault {\csname mst@boldvariant@\mst@tmp\endcsname}%
    \edef\itdefault {\csname mst@itdefault@\mst@tmp\endcsname}%
    \edef\rmdefault {\csname mst@rmdefault@\mst@tmp\endcsname}%
    \edef\sfdefault {\csname mst@sfdefault@\mst@tmp\endcsname}%
    \edef\ttdefault {\csname mst@ttdefault@\mst@tmp\endcsname}%
    \usefont{\encodingdefault}{\familydefault}{\seriesdefault}{\shapedefault}%
    \MTversion@@
}%
\newcommand*\MTversion@@ {%
    \MTexistsdoesskip
    \MTforalldoesskip
    \MTprimedoesskip
     \mst@exists@muskip\csname mst@exists@skip@\math@version\endcsname\relax
     \mst@forall@muskip\csname mst@forall@skip@\math@version\endcsname\relax
     \mst@prime@muskip\csname mst@prime@skip@\math@version\endcsname\relax
    \edef\mst@tmpa{\csname mst@ltshape@\math@version\endcsname}%
    \edef\mst@tmpb{\csname mst@shape@\math@version\endcsname}%
    \MTmathoperatorsobeymathxx
    \MTeverymathdefault
    \MTcustomizenewmcodes
    \@for\mst@tmpc:=it,sl\do{\ifx\mst@tmpc\mst@tmpa\MTnoicinmath\fi}%
    \ifmst@frenchmath
      \def\mst@ITcorr{\ifnum\fam=\m@ne\/\fi}%
      \@for\mst@tmpc:=it,sl\do{\ifx\mst@tmpc\mst@tmpb\MTnoICinmath\fi}%
    \fi
    \ifmst@subdued
      \ifx\math@version\mst@normalversionname
        \mst@restorealphabets
        \MTstandardgreek
        \MTmathoperatorsdonotobeymathxx
        \MTnormalexists
        \MTnormalforall
        \MTeverymathoff
        \MTresetnewmcodes
        \mst@subduedhbar
        \mst@subduedinodot
        \mst@subduedmathaccents
      \else
        \ifx\math@version\mst@boldversionname
          \mst@restorealphabets
          \MTstandardgreek
          \MTmathoperatorsdonotobeymathxx
          \MTnormalexists
          \MTnormalforall
          \MTeverymathoff
          \MTresetnewmcodes
          \mst@subduedhbar
          \mst@subduedinodot
          \mst@subduedmathaccents
        \else
          \mst@setalphabets
    \expandafter\let\csname ifmst@greek@upper@up\expandafter\endcsname
                    \csname ifmst@greek@\math@version @upper@up\endcsname
    \expandafter\let\csname ifmst@greek@lower@up\expandafter\endcsname
                    \csname ifmst@greek@\math@version @lower@up\endcsname
          \MTcustomgreek
          \mst@nonsubduedhbar
          \mst@nonsubduedinodot
          \mst@nonsubduedmathaccents
          \mst@nonsubduedminus
        \fi
      \fi
    \else
    \expandafter\let\csname ifmst@greek@upper@up\expandafter\endcsname
                    \csname ifmst@greek@\math@version @upper@up\endcsname
    \expandafter\let\csname ifmst@greek@lower@up\expandafter\endcsname
                    \csname ifmst@greek@\math@version @lower@up\endcsname
      \MTcustomgreek
      \mst@nonsubduedhbar
      \mst@nonsubduedinodot
      \mst@nonsubduedmathaccents
      \mst@nonsubduedminus
    \fi
}%
\let\MathastextVersion\MTversion
\let\Mathastextversion\MTversion
\let\MTVersion\MTversion
\let\mathastextversion\MTversion
\newcommand*\MTWillUse[5][]{
  \MTencoding{#2}
  \MTfamily{#3}
  \MTseries{#4}
  \MTshape{#5}
    \ifmst@italic\MTlettershape{\itdefault}\fi
  \edef\mst@tmp{#1}
  \ifx\mst@tmp\empty\else\MTlettershape{#1}\fi
  \Mathastext}
\let\MathastextWillUse\MTWillUse
\let\Mathastextwilluse\MTWillUse
\def\Mathastext {\@ifnextchar[\Mathastext@declare\Mathastext@}% ]
\def\Mathastext@declare [#1]{%
  \edef\mst@tmp{#1}%
  \ifx\mst@tmp\empty
       \expandafter\@firstoftwo
  \else\expandafter\@secondoftwo
  \fi
  \Mathastext@
  {\MTDeclareVersion[\mst@ltsh]{#1}{\mst@enc}{\mst@fam}{\mst@ser}{\mst@opsh}}%
}%
\def\Mathastext@ {%
  \mst@update@greeksh {\mst@ltsh}{\mst@opsh}%
      \expandafter\let\csname ifmst@greek@normal@upper@up\expandafter\endcsname
                      \csname ifmst@greek@upper@up\endcsname
      \expandafter\let\csname ifmst@greek@normal@lower@up\expandafter\endcsname
                      \csname ifmst@greek@lower@up\endcsname
      \expandafter\let\csname ifmst@greek@bold@upper@up\expandafter\endcsname
                      \csname ifmst@greek@upper@up\endcsname
      \expandafter\let\csname ifmst@greek@bold@lower@up\expandafter\endcsname
                      \csname ifmst@greek@lower@up\endcsname
  \edef\mst@encoding@normal{\mst@enc}%
  \edef\mst@family@normal{\mst@fam}%
  \edef\mst@series@normal{\mst@ser}%
  \edef\mst@shape@normal{\mst@opsh}%
  \edef\mst@ltshape@normal{\mst@ltsh}%
  \edef\mst@itdefault@normal{\itdefault}%
  \edef\mst@rmdefault@normal{\rmdefault}%
  \edef\mst@sfdefault@normal{\sfdefault}%
  \edef\mst@ttdefault@normal{\ttdefault}%
  \edef\mst@boldvariant@normal{\mst@bold}%
  \edef\mst@exists@skip@normal{\mst@exists@skip}%
  \edef\mst@forall@skip@normal{\mst@forall@skip}%
  \edef\mst@prime@skip@normal{\mst@prime@skip}%
  \edef\mst@encoding@bold{\mst@enc}%
  \edef\mst@family@bold{\mst@fam}%
  \edef\mst@series@bold{\mst@bold}%
  \edef\mst@shape@bold{\mst@opsh}%
  \edef\mst@ltshape@bold{\mst@ltsh}%
  \edef\mst@boldvariant@bold{\mst@bold}%
  \edef\mst@itdefault@bold{\itdefault}%
  \edef\mst@rmdefault@bold{\rmdefault}%
  \edef\mst@sfdefault@bold{\sfdefault}%
  \edef\mst@ttdefault@bold{\ttdefault}%
  \edef\mst@exists@skip@bold{\mst@exists@skip}%
  \edef\mst@forall@skip@bold{\mst@forall@skip}%
  \edef\mst@prime@skip@bold{\mst@prime@skip}%
  \ifmst@subdued
    \def\mst@exists@skip@normal{0mu}%
    \def\mst@forall@skip@normal{0mu}%
    \def\mst@prime@skip@normal{0mu}%
    \def\mst@exists@skip@bold{0mu}%
    \def\mst@forall@skip@bold{0mu}%
    \def\mst@prime@skip@bold{0mu}%
  \else
    \ifmst@italic
      \ifmst@frenchmath
        \mst@exists@muskip\mst@exists@skip\relax
        \mst@forall@muskip\mst@forall@skip\relax
        \mst@prime@muskip\mst@prime@skip\relax
      \else
       \def\mst@exists@skip@normal{0mu}%
       \def\mst@forall@skip@normal{0mu}%
       \def\mst@prime@skip@normal{0mu}%
       \def\mst@exists@skip@bold{0mu}%
       \def\mst@forall@skip@bold{0mu}%
       \def\mst@prime@skip@bold{0mu}%
      \fi
    \else
        \mst@exists@muskip\mst@exists@skip\relax
        \mst@forall@muskip\mst@forall@skip\relax
        \mst@prime@muskip\mst@prime@skip\relax
    \fi
  \fi
   \SetMathAlphabet{\Mathnormalbold}{normal}{\mst@encoding@normal}%
                                 {\mst@family@normal}%
                                 {\mst@boldvariant@normal}%
                                 {\mst@ltshape@normal}%
   \SetMathAlphabet{\Mathnormalbold}{bold}{\mst@encoding@bold}%
                                 {\mst@family@bold}%
                                 {\mst@boldvariant@bold}%
                                 {\mst@ltshape@bold}%
  \ifmst@subdued\else
   \SetSymbolFont{mtletterfont}{normal}{\mst@encoding@normal}%
                                       {\mst@family@normal}%
                                       {\mst@series@normal}%
                                       {\mst@ltshape@normal}%
   \SetSymbolFont{mtletterfont}{bold}  {\mst@encoding@bold}%
                                       {\mst@family@bold}%
                                       {\mst@series@bold}%
                                       {\mst@ltshape@bold}%
   \SetSymbolFont{mtoperatorfont}{normal}{\mst@encoding@normal}%
                                       {\mst@family@normal}%
                                       {\mst@series@normal}%
                                       {\mst@shape@normal}%
   \SetSymbolFont{mtoperatorfont}{bold} {\mst@encoding@bold}%
                                       {\mst@family@bold}%
                                       {\mst@series@bold}%
                                       {\mst@shape@bold}%
    \SetMathAlphabet{\Mathbf}{normal}{\mst@encoding@normal}%
                                 {\mst@family@normal}%
                                 {\mst@series@bold}%
                                 {\mst@shape@normal}%
    \SetMathAlphabet{\Mathbf}{bold}{\mst@encoding@bold}%
                                 {\mst@family@bold}%
                                 {\mst@series@bold}%
                                 {\mst@shape@bold}%
    \SetMathAlphabet{\Mathit}{normal}{\mst@encoding@normal}%
                                 {\mst@family@normal}%
                                 {\mst@series@normal}%
                                 {\mst@itdefault@normal}%
    \SetMathAlphabet{\Mathit}{bold}{\mst@encoding@bold}%
                                 {\mst@family@bold}%
                                 {\mst@series@bold}%
                                 {\mst@itdefault@bold}%
    \SetMathAlphabet{\Mathsf}{normal}{\mst@encoding@normal}%
                                 {\mst@sfdefault@normal}%
                                 {\mst@series@normal}%
                                 {\mst@shape@normal}%
    \SetMathAlphabet{\Mathsf}{bold}{\mst@encoding@bold}%
                                 {\mst@sfdefault@bold}%
                                 {\mst@series@bold}%
                                 {\mst@shape@bold}%
    \SetMathAlphabet{\Mathtt}{normal}{\mst@encoding@normal}%
                                 {\mst@ttdefault@normal}%
                                 {\mst@series@normal}%
                                 {\mst@shape@normal}%
    \SetMathAlphabet{\Mathtt}{bold}{\mst@encoding@bold}%
                                 {\mst@ttdefault@bold}%
                                 {\mst@series@bold}%
                                 {\mst@shape@bold}%
  \fi
  \ifmst@needeuler
    \SetSymbolFont{mteulervm}{bold}{U}{zeur}{\mst@boldvariant@normal}{n}%
    \SetMathAlphabet{\MathEulerBold}{normal}%
               {U}{zeur}{\mst@boldvariant@normal}{n}%
    \SetMathAlphabet{\MathEulerBold}{bold}%
               {U}{zeur}{\mst@boldvariant@bold}{n}%
  \fi
  \ifmst@needsymbol\SetSymbolFont{mtpsymbol}{bold}%
                     {U}{psy}{\mst@boldvariant@bold}{n}%
  \fi
   \ifmst@LGRgreeks \edef\mst@greekfont{\mst@fam}\fi
   \ifmst@selfGreeks\edef\mst@greekfont{\mst@fam}\fi
   \ifmst@LGRgreek
    \SetSymbolFont{mtgreekup}{normal}{LGR}%
            {\mst@greekfont}{\mst@series@normal}{\MTgreekupdefault}%
    \SetSymbolFont{mtgreekup}{bold}{LGR}%
            {\mst@greekfont}{\mst@boldvariant@bold}{\MTgreekupdefault}%
    \SetSymbolFont{mtgreekit}{normal}{LGR}%
            {\mst@greekfont}{\mst@series@normal}{\MTgreekitdefault}%
    \SetSymbolFont{mtgreekit}{bold}{LGR}%
            {\mst@greekfont}{\mst@boldvariant@bold}{\MTgreekitdefault}%
    \SetMathAlphabet{\mathgreekupbold}{normal}{LGR}%
            {\mst@greekfont}{\mst@boldvariant@normal}{\MTgreekupdefault}%
    \SetMathAlphabet{\mathgreekupbold}{bold}{LGR}%
            {\mst@greekfont}{\mst@boldvariant@bold}{\MTgreekupdefault}%
    \SetMathAlphabet{\mathgreekitbold}{normal}{LGR}%
            {\mst@greekfont}{\mst@boldvariant@normal}{\MTgreekitdefault}%
    \SetMathAlphabet{\mathgreekitbold}{bold}{LGR}%
            {\mst@greekfont}{\mst@boldvariant@bold}{\MTgreekitdefault}%
   \else
    \ifmst@selfGreek
     \SetSymbolFont{mtselfGreekfont}{normal}{OT1}%
            {\mst@greekfont}{\mst@series@normal}{\mst@greek@ush}%
     \SetSymbolFont{mtselfGreekfont}{bold}{OT1}%
            {\mst@greekfont}{\mst@boldvariant@bold}{\mst@greek@ush}%
    \fi
   \fi
  \ifmst@subdued
  \else
   \mst@infoline{Latin letters in the `normal\string', resp. `bold\string',}%
   \mst@infoline{math versions are now set up to use the fonts}%
   \mst@infoline{\mst@encoding@normal/\mst@family@normal/\mst@series@normal
                 /\mst@ltshape@normal, resp.
                 \mst@encoding@normal/\mst@family@normal/\mst@boldvariant@normal
                 /\mst@ltshape@normal.}%
  \ifmst@frenchmath\mst@infoline{(uppercase: \mst@shape@normal)}\fi
  \ifmst@LGRgreek
   \mst@infoline{Greek letters (upper:
      `\ifmst@greek@upper@up\MTgreekupdefault\else\MTgreekitdefault\fi\string',
                                             lower:
      `\ifmst@greek@lower@up\MTgreekupdefault\else\MTgreekitdefault\fi\string')
      will use font}%
   \mst@infoline{family `\mst@greekfont\string' (LGR).}%
   \else
     \ifmst@selfGreek
       \mst@infoline{Capital Greek letters (shape `\mst@greek@ush\string') will use font}%
       \mst@infoline{family `\mst@greekfont\string' (OT1).}%
     \fi
   \fi
   \ifmst@nodigits\else
     \mst@infoline{Other characters (digits, ...) and \string\log-like names will be}%
     \mst@infoline{typeset with the \mst@shape@normal\space shape.}%
   \fi
  \fi % not subdued
  \ifmst@nohbar\else
     \mst@infoline{\string\hbar}%
     \mst@dothe@hbarstuff
         \mst@hbar@mvnormal\mst@ltbar@mvnormal\mst@encoding@normal{normal}%
     \let\mst@hbar@mvbold\mst@hbar@mvnormal
  \fi
  \ifmst@noletters\else
    \mst@dothe@inodotstuff\inodot\jnodot\mst@encoding@normal{normal}%
    \let\mst@inodot@mvnormal\inodot
    \let\mst@inodot@mvbold\inodot
    \let\mst@jnodot@mvnormal\jnodot
    \let\mst@jnodot@mvbold\jnodot
  \fi
  \ifmst@mathaccents
    \mst@infoline{math accents}%
    \mst@dothe@mathaccentsstuff{normal}\mst@encoding@normal
  \fi
  \ifmst@nominus\else
  \ifmst@subdued
   \mst@infoline{minus is kept as is in subdued normal and bold math versions}%
  \else
   \mst@infoline{minus either as endash, Unicode minus, emdash or hyphen}%
   \ifmst@endash
    \mst@dothe@endashstuff\mst@minus@mvnormal\mst@varfam@minus@mvnormal
                          \mst@encoding@normal {normal}%
    \mst@dothe@endashstuff\mst@minus@mvbold\mst@varfam@minus@mvbold
                          \mst@encoding@normal {bold}%
   \else
    \ifmst@emdash
      \mst@dothe@emdashstuff\mst@minus@mvnormal\mst@varfam@minus@mvnormal
                            \mst@encoding@normal {normal}%
      \mst@dothe@emdashstuff\mst@minus@mvbold\mst@varfam@minus@mvbold
                            \mst@encoding@normal {bold}%
    \else
      \mst@dothe@hyphenstuff\mst@minus@mvnormal\mst@varfam@minus@mvnormal
      \let\mst@minus@mvbold\mst@minus@mvnormal
      \let\mst@varfam@minus@mvbold\mst@varfam@minus@mvnormal
    \fi
   \fi
  \fi % not subdued
  \fi % not nominus
  \ifmst@subdued
    \mst@infoline{Subdued `normal\string' and `bold\string' math versions.}%
  \fi
  \ifmst@italic
    \mst@infoline{The \ifmst@frenchmath frenchmath \else
                                        italic \fi option is in effect.}%
  \fi
}%
\let\mathastext\Mathastext
\Mathastext
\ifmst@eulergreek
      \mst@infoline{Greek letters will use the Euler font.}%
      \mst@infoline{Use \string\MathastextEulerScale{<factor>} to scale the
               font.}%
      \ifmst@subdued
          \mst@infoline{(subdued mode: `normal\string' and `bold\string' math versions}%
          \mst@infoline{\space keep the default Greek letters).}%
      \fi
\else
\ifmst@symbolgreek
       \mst@infoline{Greek letters will use the PostScript Symbol font.}%
       \mst@infoline{Use \string\MathastextSymbolScale{<factor>} to scale the font.}%
      \ifmst@subdued
          \mst@infoline{(subdued mode: `normal\string' and `bold\string' math versions}%
          \mst@infoline{\space keep the default Greek letters).}%
      \fi
\fi\fi
\ifmst@defaultsizes\else
\providecommand\@xxxpt{29.86}
\providecommand\@xxxvipt{35.83}
\ifmst@twelve
  \def\Huge{\@setfontsize\Huge\@xxxpt{36}}
  \def\HUGE{\@setfontsize\HUGE\@xxxvipt{43}}
\mst@infoline{\string\Huge\space and \string\HUGE\space have been (re)-defined.}
\else
  \def\HUGE{\@setfontsize\HUGE\@xxxpt{36}}
\mst@infoline{\string\HUGE\space has been (re)-defined.}
\fi
\def\defaultscriptratio{.8333}
\def\defaultscriptscriptratio{.7}
\DeclareMathSizes{9}{9}{7}{5}
\DeclareMathSizes{\@xpt}{\@xpt}{8}{6}
\DeclareMathSizes{\@xipt}{\@xipt}{9}{7}
\DeclareMathSizes{\@xiipt}{\@xiipt}{10}{8}
\DeclareMathSizes{\@xivpt}{\@xivpt}{\@xiipt}{10}
\DeclareMathSizes{\@xviipt}{\@xviipt}{\@xivpt}{\@xiipt}
\DeclareMathSizes{\@xxpt}{\@xxpt}{\@xviipt}{\@xivpt}
\DeclareMathSizes{\@xxvpt}{\@xxvpt}{\@xxpt}{\@xviipt}
\DeclareMathSizes{\@xxxpt}{\@xxxpt}{\@xxvpt}{\@xxpt}
\DeclareMathSizes{\@xxxvipt}{\@xxxvipt}{\@xxxpt}{\@xxvpt}
\mst@infoline{mathastext has declared larger sizes for subscripts.}
\mst@infoline{To keep LaTeX defaults, use option `defaultmathsizes\string'.}
\fi
\newcommand*\MTeverymathoff {%
    \MTnormalasterisk
    \MTnormalprime
    \MTnonlettersdonotobeymathxx
    \MTeasynonlettersdonotobeymathxx
    \MTmathstandardletters
    \MTmathstandarddigits
    \MTdonotfixfonts
}%
\AtBeginDocument {%
   \@ifpackageloaded{hyperref}
   {\def\Hurl{\begingroup\MTeverymathoff\Url}}
   {\@ifpackageloaded{url}{\DeclareUrlCommand\url{\MTeverymathoff}}{}}%
}%
\newcommand*\MTeverymathdefault {%
    \MTactiveasterisk
    \MTprimedoesskip
    \MTeasynonlettersobeymathxx
    \MTicinmath
    \MTmathactivedigits
    \MTfixfonts
}%
\ifmst@everymath
  \AtBeginDocument{%
    \everymath\expandafter{\the\everymath
        \mst@the\mst@do@nonletters \let\mst@the\@gobble
        \mst@theeasy\mst@do@easynonletters  \let\mst@theeasy\@gobble
    }%
    \everydisplay\expandafter{\the\everydisplay
        \mst@the\mst@do@nonletters \let\mst@the\@gobble
        \mst@theeasy\mst@do@easynonletters  \let\mst@theeasy\@gobble
    }%
  }
\fi
\AtBeginDocument{%
  \MTcustomizenewmcodes
  \let\mst@original@hbar\hbar
  \let\mst@original@imath\imath
  \let\mst@original@jmath\jmath
  \@tfor\@tempa:={grave}{acute}{check}{breve}{bar}%
                 {dot}{ddot}{mathring}{hat}{tilde}%
  \do
  {\expandafter\let\csname mst@original@\@tempa\expandafter\endcsname
                   \csname \@tempa\endcsname
   \expandafter\let\csname mst@original@\@tempa\space\expandafter\endcsname
                   \csname \@tempa\space\endcsname
  }%
  \edef\mst@subduedminus{\mst@mathcodenum`\noexpand\-=\the\mst@mathcodenum`\-\relax}%
  \ifmst@subdued
    \MTeverymathoff
    \MTresetnewmcodes
    \MTnoicinmath
    \MTmathoperatorsdonotobeymathxx
    \let\inodot\imath
    \let\jnodot\jmath
    \mst@subduedminus
  \else
     \mst@nonsubduedhbar
     \mst@nonsubduedminus
     \ifx\mst@itcorr\@undefined
         \def\mst@itcorr{\ifnum\fam=\m@ne\/\fi}%
         \@for\mst@tmp:=it,sl\do
           {\ifx\mst@tmp\mst@ltshape@normal\let\mst@itcorr\@empty\fi }%
     \fi
     \ifx\mst@ITcorr\@undefined
         \let\mst@ITcorr\mst@itcorr
         \ifmst@frenchmath
           \def\mst@ITcorr{\ifnum\fam=\m@ne\/\fi}%
           \@for\mst@tmp:=it,sl\do
                {\ifx\mst@tmp\mst@shape@normal\let\mst@ITcorr\@empty\fi }%
         \fi
     \fi
  \fi
}%
\AtEndOfPackage{\AtBeginDocument{\ifmst@subdued\else\mst@nonsubduedmathaccents\fi}}%
\ifmst@subdued
  \AtBeginDocument{%
  \def\mst@reserved#1\getanddefine@fonts\symletters#2#3\@nil{%
        \def\mst@normalmv@letter{#2}}%
  \expandafter\mst@reserved\mv@normal\@nil
  \def\mst@reserved#1\getanddefine@fonts\symletters#2#3\@nil{%
        \def\mst@boldmv@letter{#2}}%
  \expandafter\mst@reserved\mv@bold\@nil
  \def\mst@reserved#1\getanddefine@fonts\symoperators#2#3\@nil{%
        \def\mst@normalmv@operator{#2}}%
  \expandafter\mst@reserved\mv@normal\@nil
  \def\mst@reserved#1\getanddefine@fonts\symoperators#2#3\@nil{%
        \def\mst@boldmv@operator{#2}}%
  \expandafter\mst@reserved\mv@bold\@nil
  \edef\mst@tmp@enc{\mst@encoding@normal}%
  \def\mst@reserved#1/#2/#3/#4/{\gdef\mst@debut{#1}\gdef\mst@reste{#2/#3/#4}}%
  \begingroup\escapechar\m@ne
      \xdef\mst@funnyoti{\expandafter\string\csname OT1\endcsname}%
      \expandafter\expandafter\expandafter
          \mst@reserved\expandafter\string\mst@normalmv@operator/%
  \endgroup
  \ifx\mst@debut\mst@funnyoti\ifx\mst@tmp@enc\mst@oti\def\mst@tmp@enc{T1}\fi\fi
  \edef\mst@normalmv@operator{\expandafter\noexpand\csname
       \if1\mst@OneifUniEnc
         \ifx\mst@debut\mst@funnyoti T1\else\mst@debut\fi
       \else
         \mst@tmp@enc
       \fi/\mst@reste\endcsname}%
  \edef\mst@tmp@enc{\mst@encoding@bold}%
  \begingroup\escapechar\m@ne
      \expandafter\expandafter\expandafter
          \mst@reserved\expandafter\string\mst@boldmv@operator/%
  \endgroup
  \ifx\mst@debut\mst@funnyoti\ifx\mst@tmp@enc\mst@oti\def\mst@tmp@enc{T1}\fi\fi
  \edef\mst@boldmv@operator{\expandafter\noexpand\csname
       \if1\mst@OneifUniEnc
         \ifx\mst@debut\mst@funnyoti T1\else\mst@debut\fi
       \else
         \mst@tmp@enc
       \fi/\mst@reste\endcsname}%
  \expandafter\SetSymbolFont@
    \expandafter\mv@normal\mst@normalmv@letter\symmtletterfont
  \expandafter\SetSymbolFont@
    \expandafter\mv@bold\mst@boldmv@letter\symmtletterfont
  \expandafter\SetSymbolFont@
    \expandafter\mv@normal\mst@normalmv@operator\symmtoperatorfont
  \expandafter\SetSymbolFont@
    \expandafter\mv@bold\mst@boldmv@operator\symmtoperatorfont
  \immediate\write\m@ne{}%
  \PackageInfo{mathastext}{...entering subdued mode...\MessageBreak ...done}%
  \immediate\write\m@ne{}%
  }%
\fi
\expandafter \gdef \expandafter \@preamblecmds \expandafter {\@preamblecmds
\do\MTitgreek
\do\MTupgreek
\do\MTitGreek
\do\MTitGreek
\do\Mathastextitgreek
\do\Mathastextupgreek
\do\MathastextitGreek
\do\MathastextitGreek
\do\MTgreekfont
\do\Mathastextgreekfont
\do\MTgreekupdefault
\do\MTgreekitdefault
\do\MTDeclareVersion
\do\MathastextDeclareVersion
\do\MTWillUse
\do\MathastextWillUse
\do\Mathastextwilluse
\do\Mathastext
\do\mathastext
}
\immediate\write\m@ne{}
\PackageInfo{mathastext}{Loading is complete. \space You can now use \string\Mathastext
                         \space to\MessageBreak
                         modify the normal and bold math versions. \space
                         Use it\MessageBreak
                         with optional argument or use \string\MTDeclareVersion\space
                         to\MessageBreak
                         declare additional math versions\@gobble}
\endinput
%%
%% End of file `mathastext.sty'.
